<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Module 3 | STA303: Methods of Data Analysis II</title>
  <meta name="description" content="This is the course guide for STA303: Methods of Data Analysis II at the University of Toronto" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Module 3 | STA303: Methods of Data Analysis II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the course guide for STA303: Methods of Data Analysis II at the University of Toronto" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Module 3 | STA303: Methods of Data Analysis II" />
  
  <meta name="twitter:description" content="This is the course guide for STA303: Methods of Data Analysis II at the University of Toronto" />
  

<meta name="author" content="Prof. Liza Bolton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="m2.html"/>
<link rel="next" href="m4.html"/>
<script src="libs/header-attrs-2.10.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link rel="shortcut icon" href="images/favicon.ico" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA303: Methods of Data Analysis II</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> How to use this course guide</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#communication-policy-reminder"><i class="fa fa-check"></i><b>1.1</b> Communication policy reminder</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#intellectual-property-statement"><i class="fa fa-check"></i><b>1.2</b> Intellectual property statement</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#tutoring-companies"><i class="fa fa-check"></i><b>1.2.1</b> Tutoring companies</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>1.3</b> Contributors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i><b>2</b> Syllabus</a>
<ul>
<li class="chapter" data-level="2.1" data-path="syllabus.html"><a href="syllabus.html#course-information"><i class="fa fa-check"></i><b>2.1</b> Course information</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="syllabus.html"><a href="syllabus.html#course-description"><i class="fa fa-check"></i><b>2.1.1</b> Course description</a></li>
<li class="chapter" data-level="2.1.2" data-path="syllabus.html"><a href="syllabus.html#class-times"><i class="fa fa-check"></i><b>2.1.2</b> Class times</a></li>
<li class="chapter" data-level="2.1.3" data-path="syllabus.html"><a href="syllabus.html#materials"><i class="fa fa-check"></i><b>2.1.3</b> Materials</a></li>
<li class="chapter" data-level="2.1.4" data-path="syllabus.html"><a href="syllabus.html#teaching-team"><i class="fa fa-check"></i><b>2.1.4</b> Teaching team</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="syllabus.html"><a href="syllabus.html#land-acknowledgment"><i class="fa fa-check"></i><b>2.2</b> Land acknowledgment</a></li>
<li class="chapter" data-level="2.3" data-path="syllabus.html"><a href="syllabus.html#prerequisites"><i class="fa fa-check"></i><b>2.3</b> Prerequisites</a></li>
<li class="chapter" data-level="2.4" data-path="syllabus.html"><a href="syllabus.html#course-format-and-organization"><i class="fa fa-check"></i><b>2.4</b> Course format and organization</a></li>
<li class="chapter" data-level="2.5" data-path="syllabus.html"><a href="syllabus.html#learning-objectives"><i class="fa fa-check"></i><b>2.5</b> Learning objectives</a></li>
<li class="chapter" data-level="2.6" data-path="syllabus.html"><a href="syllabus.html#textbooks"><i class="fa fa-check"></i><b>2.6</b> Textbooks</a></li>
<li class="chapter" data-level="2.7" data-path="syllabus.html"><a href="syllabus.html#computing-and-minimum-technical-requirements"><i class="fa fa-check"></i><b>2.7</b> Computing and minimum technical requirements</a></li>
<li class="chapter" data-level="2.8" data-path="syllabus.html"><a href="syllabus.html#course-outline"><i class="fa fa-check"></i><b>2.8</b> Course outline</a></li>
<li class="chapter" data-level="2.9" data-path="syllabus.html"><a href="syllabus.html#assessments"><i class="fa fa-check"></i><b>2.9</b> Assessments</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="syllabus.html"><a href="syllabus.html#knowledge-basket"><i class="fa fa-check"></i><b>2.9.1</b> Knowledge basket</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="syllabus.html"><a href="syllabus.html#hours-expectations"><i class="fa fa-check"></i><b>2.10</b> Hours expectations</a></li>
<li class="chapter" data-level="2.11" data-path="syllabus.html"><a href="syllabus.html#marking-concerns-regrade-requests"><i class="fa fa-check"></i><b>2.11</b> Marking concerns / regrade requests</a></li>
<li class="chapter" data-level="2.12" data-path="syllabus.html"><a href="syllabus.html#missed-work-policies"><i class="fa fa-check"></i><b>2.12</b> Missed work policies</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="syllabus.html"><a href="syllabus.html#exceptions"><i class="fa fa-check"></i><b>2.12.1</b> Exceptions</a></li>
<li class="chapter" data-level="2.12.2" data-path="syllabus.html"><a href="syllabus.html#important-notes"><i class="fa fa-check"></i><b>2.12.2</b> IMPORTANT NOTES</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="syllabus.html"><a href="syllabus.html#communication-policy"><i class="fa fa-check"></i><b>2.13</b> Communication policy</a></li>
<li class="chapter" data-level="2.14" data-path="syllabus.html"><a href="syllabus.html#accommodations-and-accessibility"><i class="fa fa-check"></i><b>2.14</b> Accommodations and accessibility</a>
<ul>
<li class="chapter" data-level="2.14.1" data-path="syllabus.html"><a href="syllabus.html#accessibility-services"><i class="fa fa-check"></i><b>2.14.1</b> Accessibility services</a></li>
<li class="chapter" data-level="2.14.2" data-path="syllabus.html"><a href="syllabus.html#religious-accommodation"><i class="fa fa-check"></i><b>2.14.2</b> Religious Accommodation</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="syllabus.html"><a href="syllabus.html#recognized-study-groups"><i class="fa fa-check"></i><b>2.15</b> Recognized study groups</a></li>
<li class="chapter" data-level="2.16" data-path="syllabus.html"><a href="syllabus.html#meet-to-complete"><i class="fa fa-check"></i><b>2.16</b> Meet to complete</a></li>
<li class="chapter" data-level="2.17" data-path="syllabus.html"><a href="syllabus.html#feeling-distressed"><i class="fa fa-check"></i><b>2.17</b> Feeling distressed?</a></li>
<li class="chapter" data-level="2.18" data-path="syllabus.html"><a href="syllabus.html#intellectual-property-statement-1"><i class="fa fa-check"></i><b>2.18</b> Intellectual property statement</a></li>
<li class="chapter" data-level="2.19" data-path="syllabus.html"><a href="syllabus.html#academic-integrity"><i class="fa fa-check"></i><b>2.19</b> Academic integrity</a>
<ul>
<li class="chapter" data-level="2.19.1" data-path="syllabus.html"><a href="syllabus.html#plagiarism"><i class="fa fa-check"></i><b>2.19.1</b> Plagiarism</a></li>
<li class="chapter" data-level="2.19.2" data-path="syllabus.html"><a href="syllabus.html#specific-advice-on-untimed-assessments"><i class="fa fa-check"></i><b>2.19.2</b> Specific advice on untimed assessments</a></li>
<li class="chapter" data-level="2.19.3" data-path="syllabus.html"><a href="syllabus.html#rules-for-timed-assessments-e.g.-mixed-assessments"><i class="fa fa-check"></i><b>2.19.3</b> Rules for timed assessments (e.g., mixed assessments)</a></li>
<li class="chapter" data-level="2.19.4" data-path="syllabus.html"><a href="syllabus.html#note-be-careful-about-private-tutoring-companies"><i class="fa fa-check"></i><b>2.19.4</b> NOTE: BE CAREFUL ABOUT PRIVATE TUTORING COMPANIES</a></li>
</ul></li>
<li class="chapter" data-level="2.20" data-path="syllabus.html"><a href="syllabus.html#course-design-principles"><i class="fa fa-check"></i><b>2.20</b> Course design principles</a>
<ul>
<li class="chapter" data-level="2.20.1" data-path="syllabus.html"><a href="syllabus.html#humans-learn-better-little-and-often-but-everyone-is-burnout-from-two-years-of-a-pandemic"><i class="fa fa-check"></i><b>2.20.1</b> Humans learn better ‘little and often’ but everyone is burnout from two years of a pandemic</a></li>
<li class="chapter" data-level="2.20.2" data-path="syllabus.html"><a href="syllabus.html#writing-is-good-for-statisticians"><i class="fa fa-check"></i><b>2.20.2</b> Writing is good for statisticians</a></li>
<li class="chapter" data-level="2.20.3" data-path="syllabus.html"><a href="syllabus.html#course-content-is-accessible"><i class="fa fa-check"></i><b>2.20.3</b> Course content is Accessible</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="start-here.html"><a href="start-here.html"><i class="fa fa-check"></i><b>3</b> Start here!</a>
<ul>
<li class="chapter" data-level="3.1" data-path="start-here.html"><a href="start-here.html#introductions"><i class="fa fa-check"></i><b>3.1</b> Introductions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="start-here.html"><a href="start-here.html#professor-liza-bolton-instructor"><i class="fa fa-check"></i><b>3.1.1</b> Professor Liza Bolton, Instructor</a></li>
<li class="chapter" data-level="3.1.2" data-path="start-here.html"><a href="start-here.html#amin-banihashemi-head-ta"><i class="fa fa-check"></i><b>3.1.2</b> Amin Banihashemi, Head TA</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="start-here.html"><a href="start-here.html#a-few-things-to-know-upfront"><i class="fa fa-check"></i><b>3.2</b> A few things to know upfront</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="start-here.html"><a href="start-here.html#students-joining-off-the-waitlist"><i class="fa fa-check"></i><b>3.2.1</b> Students joining off the waitlist</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="start-here.html"><a href="start-here.html#howthiscourseworks"><i class="fa fa-check"></i><b>3.3</b> How this course works</a></li>
<li class="chapter" data-level="3.4" data-path="start-here.html"><a href="start-here.html#hours-expectations-1"><i class="fa fa-check"></i><b>3.4</b> Hours expectations</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="start-here.html"><a href="start-here.html#communication"><i class="fa fa-check"></i><b>3.4.1</b> Communication</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="start-here.html"><a href="start-here.html#to-do-now"><i class="fa fa-check"></i><b>3.5</b> To do now</a></li>
</ul></li>
<li class="part"><span><b>Assessments overview</b></span></li>
<li class="chapter" data-level="4" data-path="assessmentsoverview.html"><a href="assessmentsoverview.html"><i class="fa fa-check"></i><b>4</b> Assessment overview</a>
<ul>
<li class="chapter" data-level="4.1" data-path="assessmentsoverview.html"><a href="assessmentsoverview.html#graduate-student-modification-1002h"><i class="fa fa-check"></i><b>4.1</b> Graduate student modification (1002H)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mini-portfolio.html"><a href="mini-portfolio.html"><i class="fa fa-check"></i><b>5</b> Mini-portfolio</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mini-portfolio.html"><a href="mini-portfolio.html#general-instructions"><i class="fa fa-check"></i><b>5.1</b> General instructions</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mini-portfolio.html"><a href="mini-portfolio.html#template"><i class="fa fa-check"></i><b>5.1.1</b> Template</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mini-portfolio.html"><a href="mini-portfolio.html#submission-instructions"><i class="fa fa-check"></i><b>5.2</b> Submission instructions</a></li>
<li class="chapter" data-level="5.3" data-path="mini-portfolio.html"><a href="mini-portfolio.html#cover-page"><i class="fa fa-check"></i><b>5.3</b> Cover page</a></li>
<li class="chapter" data-level="5.4" data-path="mini-portfolio.html"><a href="mini-portfolio.html#introduction"><i class="fa fa-check"></i><b>5.4</b> Introduction</a></li>
<li class="chapter" data-level="5.5" data-path="mini-portfolio.html"><a href="mini-portfolio.html#statistical-skills-sample"><i class="fa fa-check"></i><b>5.5</b> Statistical skills sample</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="mini-portfolio.html"><a href="mini-portfolio.html#task-1-setting-up-libraries"><i class="fa fa-check"></i><b>5.5.1</b> Task 1: Setting up libraries</a></li>
<li class="chapter" data-level="5.5.2" data-path="mini-portfolio.html"><a href="mini-portfolio.html#task-2-visualizing-the-variance-of-a-binomial-random-variable-for-varying-proportions"><i class="fa fa-check"></i><b>5.5.2</b> Task 2: Visualizing the variance of a Binomial random variable for varying proportions</a></li>
<li class="chapter" data-level="5.5.3" data-path="mini-portfolio.html"><a href="mini-portfolio.html#task-3-demonstrating-frequentist-confidence-intervals-as-long-run-probabilities-of-capturing-a-population-parameter"><i class="fa fa-check"></i><b>5.5.3</b> Task 3: Demonstrating frequentist confidence intervals as long-run probabilities of capturing a population parameter</a></li>
<li class="chapter" data-level="5.5.4" data-path="mini-portfolio.html"><a href="mini-portfolio.html#task-4-investigating-whether-there-is-an-association-between-cgpa-and-sta3031002-students-correctly-answering-a-question-on-global-poverty-rates"><i class="fa fa-check"></i><b>5.5.4</b> Task 4: Investigating whether there is an association between cGPA and STA303/1002 students correctly answering a question on global poverty rates</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="mini-portfolio.html"><a href="mini-portfolio.html#writing-sample"><i class="fa fa-check"></i><b>5.6</b> Writing sample</a></li>
<li class="chapter" data-level="5.7" data-path="mini-portfolio.html"><a href="mini-portfolio.html#reflection"><i class="fa fa-check"></i><b>5.7</b> Reflection</a></li>
<li class="chapter" data-level="5.8" data-path="mini-portfolio.html"><a href="mini-portfolio.html#rubric"><i class="fa fa-check"></i><b>5.8</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="portfolio.html"><a href="portfolio.html"><i class="fa fa-check"></i><b>6</b> Portfolio</a>
<ul>
<li class="chapter" data-level="6.1" data-path="portfolio.html"><a href="portfolio.html#general-instructions-1"><i class="fa fa-check"></i><b>6.1</b> General instructions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="portfolio.html"><a href="portfolio.html#template-1"><i class="fa fa-check"></i><b>6.1.1</b> Template</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="portfolio.html"><a href="portfolio.html#submission-instructions-1"><i class="fa fa-check"></i><b>6.2</b> Submission instructions</a></li>
<li class="chapter" data-level="6.3" data-path="portfolio.html"><a href="portfolio.html#cover-page-1"><i class="fa fa-check"></i><b>6.3</b> Cover page</a></li>
<li class="chapter" data-level="6.4" data-path="portfolio.html"><a href="portfolio.html#introduction-1"><i class="fa fa-check"></i><b>6.4</b> Introduction</a></li>
<li class="chapter" data-level="6.5" data-path="portfolio.html"><a href="portfolio.html#statistical-skills-sample-1"><i class="fa fa-check"></i><b>6.5</b> Statistical skills sample</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="portfolio.html"><a href="portfolio.html#a-note-on-time-management."><i class="fa fa-check"></i><b>6.5.1</b> A note on time management.</a></li>
<li class="chapter" data-level="6.5.2" data-path="portfolio.html"><a href="portfolio.html#task-1-setting-up-libraries-and-seed-value"><i class="fa fa-check"></i><b>6.5.2</b> Task 1: Setting up libraries and seed value</a></li>
<li class="chapter" data-level="6.5.3" data-path="portfolio.html"><a href="portfolio.html#task-2a-return-to-statdew-valley-exploring-sources-of-variance-in-a-balanced-experimental-design-teaching-and-learning-world"><i class="fa fa-check"></i><b>6.5.3</b> Task 2a: Return to Statdew Valley: exploring sources of variance in a balanced experimental design (teaching and learning world)</a></li>
<li class="chapter" data-level="6.5.4" data-path="portfolio.html"><a href="portfolio.html#task-2b-applying-linear-mixed-models-for-the-strawberry-data-practical-world"><i class="fa fa-check"></i><b>6.5.4</b> Task 2b: Applying linear mixed models for the strawberry data (practical world)</a></li>
<li class="chapter" data-level="6.5.5" data-path="portfolio.html"><a href="portfolio.html#task-3a-building-a-confidence-interval-interpreter"><i class="fa fa-check"></i><b>6.5.5</b> Task 3a: Building a confidence interval interpreter</a></li>
<li class="chapter" data-level="6.5.6" data-path="portfolio.html"><a href="portfolio.html#task-3b-building-a-p-value-interpreter"><i class="fa fa-check"></i><b>6.5.6</b> Task 3b: Building a p value interpreter</a></li>
<li class="chapter" data-level="6.5.7" data-path="portfolio.html"><a href="portfolio.html#task-3c-user-instructions-and-disclaimer"><i class="fa fa-check"></i><b>6.5.7</b> Task 3c: User instructions and disclaimer</a></li>
<li class="chapter" data-level="6.5.8" data-path="portfolio.html"><a href="portfolio.html#task-4-creating-a-reproducible-example-reprex"><i class="fa fa-check"></i><b>6.5.8</b> Task 4: Creating a reproducible example (reprex)</a></li>
<li class="chapter" data-level="6.5.9" data-path="portfolio.html"><a href="portfolio.html#task-5-simulating-p-values"><i class="fa fa-check"></i><b>6.5.9</b> Task 5: Simulating p values</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="portfolio.html"><a href="portfolio.html#writing-sample-1"><i class="fa fa-check"></i><b>6.6</b> Writing sample</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="portfolio.html"><a href="portfolio.html#prompt-1"><i class="fa fa-check"></i><b>6.6.1</b> Prompt</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="portfolio.html"><a href="portfolio.html#reflection-1"><i class="fa fa-check"></i><b>6.7</b> Reflection</a></li>
<li class="chapter" data-level="6.8" data-path="portfolio.html"><a href="portfolio.html#rubric-1"><i class="fa fa-check"></i><b>6.8</b> Rubric</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mini-mixed-assessment.html"><a href="mini-mixed-assessment.html"><i class="fa fa-check"></i><b>7</b> Mini-mixed assessment</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="mini-mixed-assessment.html"><a href="mini-mixed-assessment.html#instructions-1"><i class="fa fa-check"></i><b>7.0.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mixed-assessment.html"><a href="mixed-assessment.html"><i class="fa fa-check"></i><b>8</b> Mixed assessment</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="mixed-assessment.html"><a href="mixed-assessment.html#instructions-2"><i class="fa fa-check"></i><b>8.0.1</b> Instructions</a></li>
<li class="chapter" data-level="8.1" data-path="mixed-assessment.html"><a href="mixed-assessment.html#how-your-grade-is-calculated-1"><i class="fa fa-check"></i><b>8.1</b> How your grade is calculated</a></li>
<li class="chapter" data-level="8.2" data-path="mixed-assessment.html"><a href="mixed-assessment.html#getting-help-1"><i class="fa fa-check"></i><b>8.2</b> Getting help</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mixed-assessment.html"><a href="mixed-assessment.html#academic-integrity-2"><i class="fa fa-check"></i><b>8.2.1</b> Academic integrity</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mixed-assessment.html"><a href="mixed-assessment.html#untimed-component-1"><i class="fa fa-check"></i><b>8.3</b> Untimed component</a></li>
<li class="chapter" data-level="8.4" data-path="mixed-assessment.html"><a href="mixed-assessment.html#timed-components"><i class="fa fa-check"></i><b>8.4</b> Timed components</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="final-project.html"><a href="final-project.html"><i class="fa fa-check"></i><b>9</b> Final project</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="final-project.html"><a href="final-project.html#instructions-3"><i class="fa fa-check"></i><b>9.0.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="knowledge-basket-overview.html"><a href="knowledge-basket-overview.html"><i class="fa fa-check"></i><b>10</b> Knowledge basket overview</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="knowledge-basket-overview.html"><a href="knowledge-basket-overview.html#planning-and-tips"><i class="fa fa-check"></i><b>10.0.1</b> Planning and tips</a></li>
<li class="chapter" data-level="10.0.2" data-path="knowledge-basket-overview.html"><a href="knowledge-basket-overview.html#examples"><i class="fa fa-check"></i><b>10.0.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html"><i class="fa fa-check"></i><b>11</b> Knowledge basket: Writing and peer feedback</a>
<ul>
<li class="chapter" data-level="11.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#writinggeneral"><i class="fa fa-check"></i><b>11.1</b> General instructions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#create-phase"><i class="fa fa-check"></i><b>11.1.1</b> Create phase</a></li>
<li class="chapter" data-level="11.1.2" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#assess-phase"><i class="fa fa-check"></i><b>11.1.2</b> Assess phase</a></li>
<li class="chapter" data-level="11.1.3" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#reflect-phase"><i class="fa fa-check"></i><b>11.1.3</b> Reflect phase</a></li>
<li class="chapter" data-level="11.1.4" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#general-instructions-2"><i class="fa fa-check"></i><b>11.1.4</b> General instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#module-1-writing-task"><i class="fa fa-check"></i><b>11.2</b> Module 1 writing task</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#m1-instructions"><i class="fa fa-check"></i><b>11.2.1</b> M1 Instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#module-2-writing-task"><i class="fa fa-check"></i><b>11.3</b> Module 2 writing task</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#m2-instructions"><i class="fa fa-check"></i><b>11.3.1</b> M2 Instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#module-3-writing-task"><i class="fa fa-check"></i><b>11.4</b> Module 3 writing task</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#m3-instructions"><i class="fa fa-check"></i><b>11.4.1</b> M3 instructions</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#module-4-writing-task"><i class="fa fa-check"></i><b>11.5</b> Module 4 writing task</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#m4-instructions"><i class="fa fa-check"></i><b>11.5.1</b> M4 instructions</a></li>
<li class="chapter" data-level="11.5.2" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#rubric-2"><i class="fa fa-check"></i><b>11.5.2</b> Rubric</a></li>
<li class="chapter" data-level="11.5.3" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#reference"><i class="fa fa-check"></i><b>11.5.3</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#module-5-writing-task"><i class="fa fa-check"></i><b>11.6</b> Module 5 writing task</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="knowledge-basket-writing-and-peer-feedback.html"><a href="knowledge-basket-writing-and-peer-feedback.html#m5-instructions"><i class="fa fa-check"></i><b>11.6.1</b> M5 instructions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html"><i class="fa fa-check"></i><b>12</b> Knowledge basket: Professional development task</a>
<ul>
<li class="chapter" data-level="12.1" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#professional-development-proposal"><i class="fa fa-check"></i><b>12.1</b> Professional development proposal</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#instructions-4"><i class="fa fa-check"></i><b>12.1.1</b> Instructions</a></li>
<li class="chapter" data-level="12.1.2" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#submission-requirements-1"><i class="fa fa-check"></i><b>12.1.2</b> Submission requirements</a></li>
<li class="chapter" data-level="12.1.3" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#rubric-3"><i class="fa fa-check"></i><b>12.1.3</b> Rubric</a></li>
<li class="chapter" data-level="12.1.4" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#checklist"><i class="fa fa-check"></i><b>12.1.4</b> Checklist</a></li>
<li class="chapter" data-level="12.1.5" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#things-to-keep-in-minds-as-you-start-working-towards-your-professional-development-goal"><i class="fa fa-check"></i><b>12.1.5</b> Things to keep in minds as you start working towards your professional development goal</a></li>
<li class="chapter" data-level="12.1.6" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#example-smart-goal"><i class="fa fa-check"></i><b>12.1.6</b> Example smart goal</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#professional-development-evidence-and-reflection"><i class="fa fa-check"></i><b>12.2</b> Professional development evidence and reflection</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#templates"><i class="fa fa-check"></i><b>12.2.1</b> Templates</a></li>
<li class="chapter" data-level="12.2.2" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#reflection-and-evidence-components"><i class="fa fa-check"></i><b>12.2.2</b> Reflection and evidence components</a></li>
<li class="chapter" data-level="12.2.3" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#recommended-structure"><i class="fa fa-check"></i><b>12.2.3</b> Recommended structure</a></li>
<li class="chapter" data-level="12.2.4" data-path="knowledge-basket-professional-development-task.html"><a href="knowledge-basket-professional-development-task.html#rubric-4"><i class="fa fa-check"></i><b>12.2.4</b> Rubric</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html"><i class="fa fa-check"></i><b>13</b> Knowledge basket: Other</a>
<ul>
<li class="chapter" data-level="13.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#getting-to-know-you-survey"><i class="fa fa-check"></i><b>13.1</b> ‘Getting to know you’ survey</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-5"><i class="fa fa-check"></i><b>13.1.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#pre-knowledge-check"><i class="fa fa-check"></i><b>13.2</b> Pre-knowledge check</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-6"><i class="fa fa-check"></i><b>13.2.1</b> Instructions</a></li>
<li class="chapter" data-level="13.2.2" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#workshop-attendance"><i class="fa fa-check"></i><b>13.2.2</b> Workshop attendance</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#writing-workshop"><i class="fa fa-check"></i><b>13.3</b> Writing workshop</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#workshop-attendance-1"><i class="fa fa-check"></i><b>13.3.1</b> Workshop attendance</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#module-check-ins"><i class="fa fa-check"></i><b>13.4</b> Module check-ins</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-7"><i class="fa fa-check"></i><b>13.4.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#team-up-activities"><i class="fa fa-check"></i><b>13.5</b> Team Up! activities</a></li>
<li class="chapter" data-level="13.6" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#graduate-school-info-session"><i class="fa fa-check"></i><b>13.6</b> Graduate school info session</a></li>
<li class="chapter" data-level="13.7" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#punctuation-art"><i class="fa fa-check"></i><b>13.7</b> Punctuation art</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-8"><i class="fa fa-check"></i><b>13.7.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#breathing-exercise"><i class="fa fa-check"></i><b>13.8</b> Breathing exercise</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-9"><i class="fa fa-check"></i><b>13.8.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#linear-mixed-models-study-guide"><i class="fa fa-check"></i><b>13.9</b> Linear Mixed Models study guide</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-10"><i class="fa fa-check"></i><b>13.9.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#generalized-linear-models-study-guide"><i class="fa fa-check"></i><b>13.10</b> Generalized Linear Models study guide</a>
<ul>
<li class="chapter" data-level="13.10.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-11"><i class="fa fa-check"></i><b>13.10.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.11" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#hack-your-class-workshop-attendance-and-reflection"><i class="fa fa-check"></i><b>13.11</b> Hack your class workshop attendance and reflection</a>
<ul>
<li class="chapter" data-level="13.11.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-12"><i class="fa fa-check"></i><b>13.11.1</b> Instructions</a></li>
</ul></li>
<li class="chapter" data-level="13.12" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#sports-analytics-workshop-attendance-and-reflection"><i class="fa fa-check"></i><b>13.12</b> Sports analytics workshop attendance and reflection</a>
<ul>
<li class="chapter" data-level="13.12.1" data-path="knowledge-basket-other.html"><a href="knowledge-basket-other.html#instructions-13"><i class="fa fa-check"></i><b>13.12.1</b> Instructions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Modules</b></span></li>
<li class="chapter" data-level="14" data-path="m1.html"><a href="m1.html"><i class="fa fa-check"></i><b>14</b> Module 1</a>
<ul>
<li class="chapter" data-level="14.1" data-path="m1.html"><a href="m1.html#learning-checklist"><i class="fa fa-check"></i><b>14.1</b> Learning checklist</a></li>
<li class="chapter" data-level="14.2" data-path="m1.html"><a href="m1.html#instructor-information"><i class="fa fa-check"></i><b>14.2</b> Instructor information</a></li>
<li class="chapter" data-level="14.3" data-path="m1.html"><a href="m1.html#upward-management-tips"><i class="fa fa-check"></i><b>14.3</b> Upward management tips</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="m1.html"><a href="m1.html#communicate-using-the-tools-your-manager-prefers"><i class="fa fa-check"></i><b>14.3.1</b> Communicate using the tools your manager prefers</a></li>
<li class="chapter" data-level="14.3.2" data-path="m1.html"><a href="m1.html#write-good-emails-when-emails-are-appropriate"><i class="fa fa-check"></i><b>14.3.2</b> Write good emails (when emails are appropriate)</a></li>
<li class="chapter" data-level="14.3.3" data-path="m1.html"><a href="m1.html#understand-your-managers-goals"><i class="fa fa-check"></i><b>14.3.3</b> Understand your manager’s goals</a></li>
<li class="chapter" data-level="14.3.4" data-path="m1.html"><a href="m1.html#demonstrate-self-management-and-resilience-while-also-asking-for-help-and-flagging-problems-early."><i class="fa fa-check"></i><b>14.3.4</b> Demonstrate self-management and resilience while also asking for help and flagging problems early.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="m1.html"><a href="m1.html#recap-of-linear-models"><i class="fa fa-check"></i><b>14.4</b> Recap of linear models</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="m1.html"><a href="m1.html#why-model"><i class="fa fa-check"></i><b>14.4.1</b> Why model?</a></li>
<li class="chapter" data-level="14.4.2" data-path="m1.html"><a href="m1.html#linear-models"><i class="fa fa-check"></i><b>14.4.2</b> Linear models</a></li>
<li class="chapter" data-level="14.4.3" data-path="m1.html"><a href="m1.html#linear-regression-assumptions"><i class="fa fa-check"></i><b>14.4.3</b> Linear regression assumptions</a></li>
<li class="chapter" data-level="14.4.4" data-path="m1.html"><a href="m1.html#what-makes-it-a-linear-model"><i class="fa fa-check"></i><b>14.4.4</b> What makes it a <em>linear</em> model?</a></li>
<li class="chapter" data-level="14.4.5" data-path="m1.html"><a href="m1.html#optional-refresher-reading"><i class="fa fa-check"></i><b>14.4.5</b> Optional refresher reading</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="m1.html"><a href="m1.html#the-data-for-module-1"><i class="fa fa-check"></i><b>14.5</b> The data for module 1</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="m1.html"><a href="m1.html#lets-meet-the-penguins"><i class="fa fa-check"></i><b>14.5.1</b> Let’s meet the penguins</a></li>
<li class="chapter" data-level="14.5.2" data-path="m1.html"><a href="m1.html#the-variables"><i class="fa fa-check"></i><b>14.5.2</b> The variables</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="m1.html"><a href="m1.html#common-statistical-tests-as-linear-regression"><i class="fa fa-check"></i><b>14.6</b> Common statistical tests as linear regression</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="m1.html"><a href="m1.html#introduction-2"><i class="fa fa-check"></i><b>14.6.1</b> Introduction</a></li>
<li class="chapter" data-level="14.6.2" data-path="m1.html"><a href="m1.html#one-sample-t-test"><i class="fa fa-check"></i><b>14.6.2</b> One-sample t-test</a></li>
<li class="chapter" data-level="14.6.3" data-path="m1.html"><a href="m1.html#dummy-variables"><i class="fa fa-check"></i><b>14.6.3</b> Dummy variables</a></li>
<li class="chapter" data-level="14.6.4" data-path="m1.html"><a href="m1.html#two-means"><i class="fa fa-check"></i><b>14.6.4</b> Two means</a></li>
<li class="chapter" data-level="14.6.5" data-path="m1.html"><a href="m1.html#anova"><i class="fa fa-check"></i><b>14.6.5</b> ANOVA</a></li>
<li class="chapter" data-level="14.6.6" data-path="m1.html"><a href="m1.html#credits"><i class="fa fa-check"></i><b>14.6.6</b> Credits</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="m1.html"><a href="m1.html#reproducible-examples-reprex"><i class="fa fa-check"></i><b>14.7</b> Reproducible examples (reprex)</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="m1.html"><a href="m1.html#what-is-a-reproducible-example"><i class="fa fa-check"></i><b>14.7.1</b> What is a reproducible example?</a></li>
<li class="chapter" data-level="14.7.2" data-path="m1.html"><a href="m1.html#why-should-you-care-about-creating-reproducible-examples"><i class="fa fa-check"></i><b>14.7.2</b> Why should you care about creating reproducible examples?</a></li>
<li class="chapter" data-level="14.7.3" data-path="m1.html"><a href="m1.html#watch-the-creator-of-the-reprex-package-explain-it"><i class="fa fa-check"></i><b>14.7.3</b> Watch the creator of the reprex package explain it</a></li>
<li class="chapter" data-level="14.7.4" data-path="m1.html"><a href="m1.html#using-reprexes-on-piazza"><i class="fa fa-check"></i><b>14.7.4</b> Using reprexes on Piazza</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="m1.html"><a href="m1.html#previewskim"><i class="fa fa-check"></i><b>14.8</b> Reading strategy: previewing and skimming</a></li>
<li class="chapter" data-level="14.9" data-path="m1.html"><a href="m1.html#getting-ahead-on-module-2"><i class="fa fa-check"></i><b>14.9</b> Getting ahead on Module 2</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="m2.html"><a href="m2.html"><i class="fa fa-check"></i><b>15</b> Module 2</a>
<ul>
<li class="chapter" data-level="15.1" data-path="m2.html"><a href="m2.html#learning-checklist-1"><i class="fa fa-check"></i><b>15.1</b> Learning checklist</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="m2.html"><a href="m2.html#key-functions"><i class="fa fa-check"></i><b>15.1.1</b> Key functions</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="m2.html"><a href="m2.html#introduction-to-module-2"><i class="fa fa-check"></i><b>15.2</b> Introduction to Module 2</a></li>
<li class="chapter" data-level="15.3" data-path="m2.html"><a href="m2.html#readings-for-this-module"><i class="fa fa-check"></i><b>15.3</b> Readings for this module</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="m2.html"><a href="m2.html#r-for-data-science-story-time"><i class="fa fa-check"></i><b>15.3.1</b> R for Data Science (+ story time)</a></li>
<li class="chapter" data-level="15.3.2" data-path="m2.html"><a href="m2.html#common-misconceptions-about-data-analysis-and-statistics"><i class="fa fa-check"></i><b>15.3.2</b> Common misconceptions about data analysis and statistics</a></li>
<li class="chapter" data-level="15.3.3" data-path="m2.html"><a href="m2.html#to-predict-and-serve"><i class="fa fa-check"></i><b>15.3.3</b> To predict and serve?</a></li>
<li class="chapter" data-level="15.3.4" data-path="m2.html"><a href="m2.html#science-isnt-broken"><i class="fa fa-check"></i><b>15.3.4</b> Science isn’t broken</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="m2.html"><a href="m2.html#data-wrangling-and-visualization"><i class="fa fa-check"></i><b>15.4</b> Data wrangling and visualization</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="m2.html"><a href="m2.html#tidy-data"><i class="fa fa-check"></i><b>15.4.1</b> Tidy data</a></li>
<li class="chapter" data-level="15.4.2" data-path="m2.html"><a href="m2.html#student-grades-case-study"><i class="fa fa-check"></i><b>15.4.2</b> Student grades case study</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="m2.html"><a href="m2.html#ethical-professional-practice-for-statisticians"><i class="fa fa-check"></i><b>15.5</b> Ethical professional practice for statisticians</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="m2.html"><a href="m2.html#why-should-statisticians-be-ethical"><i class="fa fa-check"></i><b>15.5.1</b> Why should statisticians be ethical?</a></li>
<li class="chapter" data-level="15.5.2" data-path="m2.html"><a href="m2.html#getting-data"><i class="fa fa-check"></i><b>15.5.2</b> Getting data</a></li>
<li class="chapter" data-level="15.5.3" data-path="m2.html"><a href="m2.html#analyzingethics"><i class="fa fa-check"></i><b>15.5.3</b> Analyzing data</a></li>
<li class="chapter" data-level="15.5.4" data-path="m2.html"><a href="m2.html#making-decisions-with-data"><i class="fa fa-check"></i><b>15.5.4</b> Making decisions with data</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="m2.html"><a href="m2.html#statistical-communication"><i class="fa fa-check"></i><b>15.6</b> Statistical communication</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="m2.html"><a href="m2.html#prioritize-statistical-communication-as-part-of-your-toolbox"><i class="fa fa-check"></i><b>15.6.1</b> Prioritize statistical communication as part of your toolbox</a></li>
<li class="chapter" data-level="15.6.2" data-path="m2.html"><a href="m2.html#what-do-statisticians-usually-write"><i class="fa fa-check"></i><b>15.6.2</b> What do statisticians usually <em>write</em>?</a></li>
<li class="chapter" data-level="15.6.3" data-path="m2.html"><a href="m2.html#common-report-components"><i class="fa fa-check"></i><b>15.6.3</b> Common report components</a></li>
<li class="chapter" data-level="15.6.4" data-path="m2.html"><a href="m2.html#paraphrasing"><i class="fa fa-check"></i><b>15.6.4</b> Paraphrasing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="m3.html"><a href="m3.html"><i class="fa fa-check"></i><b>16</b> Module 3</a>
<ul>
<li class="chapter" data-level="16.1" data-path="m3.html"><a href="m3.html#learning-checklist-2"><i class="fa fa-check"></i><b>16.1</b> Learning checklist</a></li>
<li class="chapter" data-level="16.2" data-path="m3.html"><a href="m3.html#introduction-3"><i class="fa fa-check"></i><b>16.2</b> Introduction</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="m3.html"><a href="m3.html#how-deep-are-we-going-on-likelihoods"><i class="fa fa-check"></i><b>16.2.1</b> How deep are we going on likelihoods?</a></li>
<li class="chapter" data-level="16.2.2" data-path="m3.html"><a href="m3.html#model-comparison-more-generally"><i class="fa fa-check"></i><b>16.2.2</b> Model comparison more generally</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="m3.html"><a href="m3.html#correlated-data"><i class="fa fa-check"></i><b>16.3</b> Correlated data</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="m3.html"><a href="m3.html#reading"><i class="fa fa-check"></i><b>16.3.1</b> Reading</a></li>
<li class="chapter" data-level="16.3.2" data-path="m3.html"><a href="m3.html#key-vocabulary"><i class="fa fa-check"></i><b>16.3.2</b> Key vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="m3.html"><a href="m3.html#statdew-valley-interactive"><i class="fa fa-check"></i><b>16.4</b> Statdew Valley interactive</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="m3.html"><a href="m3.html#welcome-to-statdew-valley"><i class="fa fa-check"></i><b>16.4.1</b> Welcome to Statdew Valley!</a></li>
<li class="chapter" data-level="16.4.2" data-path="m3.html"><a href="m3.html#optional-create-your-16-bit-character"><i class="fa fa-check"></i><b>16.4.2</b> Optional: Create your 16 bit character</a></li>
<li class="chapter" data-level="16.4.3" data-path="m3.html"><a href="m3.html#task-1-tomatoes-part-1"><i class="fa fa-check"></i><b>16.4.3</b> Task 1: Tomatoes (part 1)</a></li>
<li class="chapter" data-level="16.4.4" data-path="m3.html"><a href="m3.html#task-1-tomatoes-part-2"><i class="fa fa-check"></i><b>16.4.4</b> Task 1: Tomatoes (part 2)</a></li>
<li class="chapter" data-level="16.4.5" data-path="m3.html"><a href="m3.html#task-2-life-is-sweet-as-honey"><i class="fa fa-check"></i><b>16.4.5</b> Task 2: Life is sweet as honey</a></li>
<li class="chapter" data-level="16.4.6" data-path="m3.html"><a href="m3.html#where-to-next"><i class="fa fa-check"></i><b>16.4.6</b> Where to next?</a></li>
<li class="chapter" data-level="16.4.7" data-path="m3.html"><a href="m3.html#credits-1"><i class="fa fa-check"></i><b>16.4.7</b> Credits</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="m3.html"><a href="m3.html#vocal-pitch-case-study-part-1-lmms"><i class="fa fa-check"></i><b>16.5</b> Vocal pitch case study: Part 1 (LMMs)</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="m3.html"><a href="m3.html#motivation"><i class="fa fa-check"></i><b>16.5.1</b> Motivation</a></li>
<li class="chapter" data-level="16.5.2" data-path="m3.html"><a href="m3.html#design-of-the-experiment"><i class="fa fa-check"></i><b>16.5.2</b> Design of the experiment</a></li>
<li class="chapter" data-level="16.5.3" data-path="m3.html"><a href="m3.html#read-in-the-data-and-explore-it"><i class="fa fa-check"></i><b>16.5.3</b> Read in the data and explore it</a></li>
<li class="chapter" data-level="16.5.4" data-path="m3.html"><a href="m3.html#recall-linear-regression-assumptions"><i class="fa fa-check"></i><b>16.5.4</b> Recall: Linear regression assumptions</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="m3.html"><a href="m3.html#linear-mixed-models"><i class="fa fa-check"></i><b>16.6</b> Linear mixed models</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="m3.html"><a href="m3.html#thoughts-on-plots-for-hierarchicalcorrelated-data-generally"><i class="fa fa-check"></i><b>16.6.1</b> Thoughts on plots for hierarchical/correlated data generally</a></li>
<li class="chapter" data-level="16.6.2" data-path="m3.html"><a href="m3.html#assumptions-3"><i class="fa fa-check"></i><b>16.6.2</b> Assumptions</a></li>
<li class="chapter" data-level="16.6.3" data-path="m3.html"><a href="m3.html#our-model-set-up"><i class="fa fa-check"></i><b>16.6.3</b> Our model set up</a></li>
<li class="chapter" data-level="16.6.4" data-path="m3.html"><a href="m3.html#what-can-correlated-errors-look-like"><i class="fa fa-check"></i><b>16.6.4</b> What can correlated errors look like?</a></li>
<li class="chapter" data-level="16.6.5" data-path="m3.html"><a href="m3.html#how-do-we-tell-r-which-situation-were-in"><i class="fa fa-check"></i><b>16.6.5</b> How do we tell R which situation we’re in?</a></li>
<li class="chapter" data-level="16.6.6" data-path="m3.html"><a href="m3.html#additional-considerations"><i class="fa fa-check"></i><b>16.6.6</b> Additional considerations</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="m3.html"><a href="m3.html#vocal-pitch-case-study-part-2"><i class="fa fa-check"></i><b>16.7</b> Vocal pitch case study: Part 2</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="m3.html"><a href="m3.html#modelling-individual-means-with-random-intercepts"><i class="fa fa-check"></i><b>16.7.1</b> Modelling individual means with random intercepts</a></li>
<li class="chapter" data-level="16.7.2" data-path="m3.html"><a href="m3.html#scenario-random-slopes"><i class="fa fa-check"></i><b>16.7.2</b> Scenario random slopes</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="m3.html"><a href="m3.html#interactions-between-random-effects-and-fixed-effects"><i class="fa fa-check"></i><b>16.8</b> Interactions between random effects and fixed effects</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="m3.html"><a href="m3.html#model-formula-2"><i class="fa fa-check"></i><b>16.8.1</b> Model formula</a></li>
<li class="chapter" data-level="16.8.2" data-path="m3.html"><a href="m3.html#how-would-we-fit-this-with-lmer"><i class="fa fa-check"></i><b>16.8.2</b> How would we fit this with <code>lmer</code>?</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="m3.html"><a href="m3.html#more-fixed-vs-random-effects-practice"><i class="fa fa-check"></i><b>16.9</b> More fixed vs random effects practice</a>
<ul>
<li class="chapter" data-level="16.9.1" data-path="m3.html"><a href="m3.html#answers"><i class="fa fa-check"></i><b>16.9.1</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="16.10" data-path="m3.html"><a href="m3.html#advice-for-polishing-your-writing"><i class="fa fa-check"></i><b>16.10</b> Advice for polishing your writing</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="m4.html"><a href="m4.html"><i class="fa fa-check"></i><b>17</b> Module 4</a>
<ul>
<li class="chapter" data-level="17.1" data-path="m4.html"><a href="m4.html#learning-checklist-3"><i class="fa fa-check"></i><b>17.1</b> Learning checklist</a></li>
<li class="chapter" data-level="17.2" data-path="m4.html"><a href="m4.html#introduction-4"><i class="fa fa-check"></i><b>17.2</b> Introduction</a></li>
<li class="chapter" data-level="17.3" data-path="m4.html"><a href="m4.html#distributions-recap"><i class="fa fa-check"></i><b>17.3</b> Distributions (recap)</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="m4.html"><a href="m4.html#sections-to-preview-and-skim"><i class="fa fa-check"></i><b>17.3.1</b> Sections to preview and skim</a></li>
<li class="chapter" data-level="17.3.2" data-path="m4.html"><a href="m4.html#reading-guide"><i class="fa fa-check"></i><b>17.3.2</b> Reading guide</a></li>
<li class="chapter" data-level="17.3.3" data-path="m4.html"><a href="m4.html#cheat-sheet-template"><i class="fa fa-check"></i><b>17.3.3</b> Cheat sheet template</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="m4.html"><a href="m4.html#ontario-covid-hospitalizations"><i class="fa fa-check"></i><b>17.4</b> Ontario COVID hospitalizations</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="m4.html"><a href="m4.html#creating-tables-in-r"><i class="fa fa-check"></i><b>17.4.1</b> Creating tables in R</a></li>
<li class="chapter" data-level="17.4.2" data-path="m4.html"><a href="m4.html#creating-tables"><i class="fa fa-check"></i><b>17.4.2</b> Creating tables</a></li>
<li class="chapter" data-level="17.4.3" data-path="m4.html"><a href="m4.html#calculations-with-tables"><i class="fa fa-check"></i><b>17.4.3</b> Calculations with tables</a></li>
<li class="chapter" data-level="17.4.4" data-path="m4.html"><a href="m4.html#joint-probabilities"><i class="fa fa-check"></i><b>17.4.4</b> Joint probabilities</a></li>
<li class="chapter" data-level="17.4.5" data-path="m4.html"><a href="m4.html#marginal-probabilities"><i class="fa fa-check"></i><b>17.4.5</b> Marginal probabilities</a></li>
<li class="chapter" data-level="17.4.6" data-path="m4.html"><a href="m4.html#conditional-probabilities"><i class="fa fa-check"></i><b>17.4.6</b> Conditional probabilities</a></li>
<li class="chapter" data-level="17.4.7" data-path="m4.html"><a href="m4.html#risk-and-odds"><i class="fa fa-check"></i><b>17.4.7</b> Risk and odds</a></li>
<li class="chapter" data-level="17.4.8" data-path="m4.html"><a href="m4.html#hospitalization-risk-and-odds"><i class="fa fa-check"></i><b>17.4.8</b> Hospitalization risk and odds</a></li>
<li class="chapter" data-level="17.4.9" data-path="m4.html"><a href="m4.html#odds-ratio-and-risk-ratios"><i class="fa fa-check"></i><b>17.4.9</b> Odds ratio and risk ratios</a></li>
<li class="chapter" data-level="17.4.10" data-path="m4.html"><a href="m4.html#when-do-we-use-rr-vs-or"><i class="fa fa-check"></i><b>17.4.10</b> When do we use RR vs OR?</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="m4.html"><a href="m4.html#generalized-linear-models-glms"><i class="fa fa-check"></i><b>17.5</b> Generalized linear models (GLMs)</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="m4.html"><a href="m4.html#assumptions-of-the-generalized-linear-model"><i class="fa fa-check"></i><b>17.5.1</b> Assumptions of the Generalized Linear Model</a></li>
<li class="chapter" data-level="17.5.2" data-path="m4.html"><a href="m4.html#components-of-a-generalized-linear-model"><i class="fa fa-check"></i><b>17.5.2</b> Components of a Generalized Linear Model</a></li>
<li class="chapter" data-level="17.5.3" data-path="m4.html"><a href="m4.html#generalized-linear-models"><i class="fa fa-check"></i><b>17.5.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="17.5.4" data-path="m4.html"><a href="m4.html#ordinary-least-squares-again"><i class="fa fa-check"></i><b>17.5.4</b> Ordinary Least Squares again</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="m4.html"><a href="m4.html#binomial-or-logistic-regression"><i class="fa fa-check"></i><b>17.6</b> Binomial (or logistic) regression</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="m4.html"><a href="m4.html#case-study-challenger-disaster"><i class="fa fa-check"></i><b>17.6.1</b> Case study: Challenger disaster</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="m4.html"><a href="m4.html#glms-a-unifying-theory"><i class="fa fa-check"></i><b>17.7</b> GLMS: A unifying theory</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="m4.html"><a href="m4.html#optional-accompanying-video"><i class="fa fa-check"></i><b>17.7.1</b> Optional accompanying video</a></li>
<li class="chapter" data-level="17.7.2" data-path="m4.html"><a href="m4.html#readings"><i class="fa fa-check"></i><b>17.7.2</b> Readings</a></li>
<li class="chapter" data-level="17.7.3" data-path="m4.html"><a href="m4.html#recall"><i class="fa fa-check"></i><b>17.7.3</b> Recall</a></li>
<li class="chapter" data-level="17.7.4" data-path="m4.html"><a href="m4.html#exponential-family-forms"><i class="fa fa-check"></i><b>17.7.4</b> Exponential family forms</a></li>
<li class="chapter" data-level="17.7.5" data-path="m4.html"><a href="m4.html#canonical-link-functions"><i class="fa fa-check"></i><b>17.7.5</b> Canonical link functions</a></li>
<li class="chapter" data-level="17.7.6" data-path="m4.html"><a href="m4.html#exponential-family-of-distributions"><i class="fa fa-check"></i><b>17.7.6</b> Exponential Family of Distributions</a></li>
<li class="chapter" data-level="17.7.7" data-path="m4.html"><a href="m4.html#iteratively-re-weighted-least-squares-algorithm-a-sketch"><i class="fa fa-check"></i><b>17.7.7</b> Iteratively re-weighted least squares algorithm (a sketch)</a></li>
<li class="chapter" data-level="17.7.8" data-path="m4.html"><a href="m4.html#a-quick-note-on-the-large-sample-distribution-of-hatbeta"><i class="fa fa-check"></i><b>17.7.8</b> A quick note on the large sample distribution of <span class="math inline">\(\hat{\beta}\)</span></a></li>
<li class="chapter" data-level="17.7.9" data-path="m4.html"><a href="m4.html#deviance"><i class="fa fa-check"></i><b>17.7.9</b> Deviance</a></li>
<li class="chapter" data-level="17.7.10" data-path="m4.html"><a href="m4.html#reading-logistic-regression"><i class="fa fa-check"></i><b>17.7.10</b> Reading: Logistic regression</a></li>
<li class="chapter" data-level="17.7.11" data-path="m4.html"><a href="m4.html#logistic-regression-case-study-trying-to-lose-weight"><i class="fa fa-check"></i><b>17.7.11</b> Logistic regression case study: Trying to lose weight</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="m4.html"><a href="m4.html#poisson-regression-key-concepts-reading"><i class="fa fa-check"></i><b>17.8</b> Poisson regression key concepts + reading</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="m4.html"><a href="m4.html#reading-1"><i class="fa fa-check"></i><b>17.8.1</b> Reading</a></li>
<li class="chapter" data-level="17.8.2" data-path="m4.html"><a href="m4.html#key-concepts-for-poisson-regression"><i class="fa fa-check"></i><b>17.8.2</b> Key concepts for Poisson regression</a></li>
<li class="chapter" data-level="17.8.3" data-path="m4.html"><a href="m4.html#poisson-regression-case-studies-1-household-size-in-the-philippines-and-2-campus-crime"><i class="fa fa-check"></i><b>17.8.3</b> Poisson regression case studies: (1) Household size in the Philippines and (2) Campus crime</a></li>
<li class="chapter" data-level="17.8.4" data-path="m4.html"><a href="m4.html#access-the-code-for-the-case-studies-optional"><i class="fa fa-check"></i><b>17.8.4</b> Access the code for the case studies (optional)</a></li>
</ul></li>
<li class="chapter" data-level="17.9" data-path="m4.html"><a href="m4.html#extra-for-the-curious-not-assessed"><i class="fa fa-check"></i><b>17.9</b> Extra for the curious (NOT assessed)</a>
<ul>
<li class="chapter" data-level="17.9.1" data-path="m4.html"><a href="m4.html#efficient-maximization-for-your-reference-only"><i class="fa fa-check"></i><b>17.9.1</b> Efficient maximization (for your reference only)</a></li>
<li class="chapter" data-level="17.9.2" data-path="m4.html"><a href="m4.html#numerical-maximizers-for-your-reference-only"><i class="fa fa-check"></i><b>17.9.2</b> Numerical maximizers (for your reference only)</a></li>
<li class="chapter" data-level="17.9.3" data-path="m4.html"><a href="m4.html#automatic-differentiation-for-your-reference-only"><i class="fa fa-check"></i><b>17.9.3</b> Automatic differentiation (for your reference only)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="m5.html"><a href="m5.html"><i class="fa fa-check"></i><b>18</b> Module 5</a>
<ul>
<li class="chapter" data-level="18.1" data-path="m5.html"><a href="m5.html#introduction-5"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="m5.html"><a href="m5.html#glmms"><i class="fa fa-check"></i><b>18.2</b> GLMMs</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="m5.html"><a href="m5.html#what-were-mixed-effects-again"><i class="fa fa-check"></i><b>18.2.1</b> What were mixed effects, again?</a></li>
<li class="chapter" data-level="18.2.2" data-path="m5.html"><a href="m5.html#pros-and-cons-of-generalized-linear-mixed-models"><i class="fa fa-check"></i><b>18.2.2</b> Pros and cons of generalized linear mixed models</a></li>
<li class="chapter" data-level="18.2.3" data-path="m5.html"><a href="m5.html#assumptions-5"><i class="fa fa-check"></i><b>18.2.3</b> Assumptions</a></li>
<li class="chapter" data-level="18.2.4" data-path="m5.html"><a href="m5.html#example-bacteria-in-blood-samples"><i class="fa fa-check"></i><b>18.2.4</b> Example: Bacteria in blood samples 🦠💉</a></li>
<li class="chapter" data-level="18.2.5" data-path="m5.html"><a href="m5.html#inference-for-glmms"><i class="fa fa-check"></i><b>18.2.5</b> Inference for GLMMs</a></li>
<li class="chapter" data-level="18.2.6" data-path="m5.html"><a href="m5.html#problems-with-likelihood-that-affect-our-inference-for-glmms"><i class="fa fa-check"></i><b>18.2.6</b> Problems with Likelihood that affect our inference for GLMMs</a></li>
<li class="chapter" data-level="18.2.7" data-path="m5.html"><a href="m5.html#back-to-the-bacteria"><i class="fa fa-check"></i><b>18.2.7</b> Back to the bacteria</a></li>
<li class="chapter" data-level="18.2.8" data-path="m5.html"><a href="m5.html#generalized-linear-mixed-models-more-generally"><i class="fa fa-check"></i><b>18.2.8</b> Generalized Linear Mixed Models, more generally</a></li>
<li class="chapter" data-level="18.2.9" data-path="m5.html"><a href="m5.html#some-key-conclusions"><i class="fa fa-check"></i><b>18.2.9</b> Some key conclusions</a></li>
<li class="chapter" data-level="18.2.10" data-path="m5.html"><a href="m5.html#glmm-reading"><i class="fa fa-check"></i><b>18.2.10</b> GLMM Reading</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="m5.html"><a href="m5.html#case-control-studies-and-conditional-logistic-regression-optional"><i class="fa fa-check"></i><b>18.3</b> Case control studies and conditional logistic regression (OPTIONAL)</a></li>
<li class="chapter" data-level="18.4" data-path="m5.html"><a href="m5.html#gams"><i class="fa fa-check"></i><b>18.4</b> GAMs</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="m5.html"><a href="m5.html#a-one-tweet-gam-lesson"><i class="fa fa-check"></i><b>18.4.1</b> A one tweet GAM lesson</a></li>
<li class="chapter" data-level="18.4.2" data-path="m5.html"><a href="m5.html#some-fake-data"><i class="fa fa-check"></i><b>18.4.2</b> Some fake data</a></li>
<li class="chapter" data-level="18.4.3" data-path="m5.html"><a href="m5.html#linear-model"><i class="fa fa-check"></i><b>18.4.3</b> Linear model?</a></li>
<li class="chapter" data-level="18.4.4" data-path="m5.html"><a href="m5.html#how-do-we-get-the-wiggles"><i class="fa fa-check"></i><b>18.4.4</b> How do we get the wiggles?</a></li>
<li class="chapter" data-level="18.4.5" data-path="m5.html"><a href="m5.html#splines"><i class="fa fa-check"></i><b>18.4.5</b> Splines</a></li>
<li class="chapter" data-level="18.4.6" data-path="m5.html"><a href="m5.html#picturing-basis-functions"><i class="fa fa-check"></i><b>18.4.6</b> Picturing basis functions</a></li>
<li class="chapter" data-level="18.4.7" data-path="m5.html"><a href="m5.html#wiggle-wiggle-wiggle"><i class="fa fa-check"></i><b>18.4.7</b> Wiggle, wiggle, wiggle</a></li>
<li class="chapter" data-level="18.4.8" data-path="m5.html"><a href="m5.html#choices-to-make"><i class="fa fa-check"></i><b>18.4.8</b> Choices to make</a></li>
<li class="chapter" data-level="18.4.9" data-path="m5.html"><a href="m5.html#generalized-additive-mixed-models"><i class="fa fa-check"></i><b>18.4.9</b> Generalized additive (mixed) models</a></li>
<li class="chapter" data-level="18.4.10" data-path="m5.html"><a href="m5.html#random-effects"><i class="fa fa-check"></i><b>18.4.10</b> Random effects</a></li>
<li class="chapter" data-level="18.4.11" data-path="m5.html"><a href="m5.html#case-studies-cherry-trees-and-portugese-larks"><i class="fa fa-check"></i><b>18.4.11</b> Case studies: Cherry trees and Portugese larks</a></li>
<li class="chapter" data-level="18.4.12" data-path="m5.html"><a href="m5.html#further-comments-on-gams"><i class="fa fa-check"></i><b>18.4.12</b> Further comments on GAMs</a></li>
<li class="chapter" data-level="18.4.13" data-path="m5.html"><a href="m5.html#conclusions"><i class="fa fa-check"></i><b>18.4.13</b> Conclusions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="part"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="19" data-path="resources.html"><a href="resources.html"><i class="fa fa-check"></i><b>19</b> Resources</a>
<ul>
<li class="chapter" data-level="19.1" data-path="resources.html"><a href="resources.html#course-tools-overview"><i class="fa fa-check"></i><b>19.1</b> Course tools overview</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="resources.html"><a href="resources.html#admin"><i class="fa fa-check"></i><b>19.1.1</b> Admin</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="resources.html"><a href="resources.html#using-rstudio-with-the-jupyterhub"><i class="fa fa-check"></i><b>19.2</b> Using RStudio with the JupyterHub</a></li>
<li class="chapter" data-level="19.3" data-path="resources.html"><a href="resources.html#team-up"><i class="fa fa-check"></i><b>19.3</b> Team Up!</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="resources.html"><a href="resources.html#to-participate-in-these-activities-you-need"><i class="fa fa-check"></i><b>19.3.1</b> To participate in these activities, you <strong>need</strong>:</a></li>
<li class="chapter" data-level="19.3.2" data-path="resources.html"><a href="resources.html#before-the-activity-you-should"><i class="fa fa-check"></i><b>19.3.2</b> <strong>Before</strong> the activity you should:</a></li>
<li class="chapter" data-level="19.3.3" data-path="resources.html"><a href="resources.html#some-ruleslogistics"><i class="fa fa-check"></i><b>19.3.3</b> Some rules/logistics</a></li>
<li class="chapter" data-level="19.3.4" data-path="resources.html"><a href="resources.html#team-up-instructions"><i class="fa fa-check"></i><b>19.3.4</b> Team Up! Instructions</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="resources.html"><a href="resources.html#zoomzoomzoomzoom"><i class="fa fa-check"></i><b>19.4</b> Zoom, Zoom, Zoom, Zoom…</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="resources.html"><a href="resources.html#make-sure-your-zoom-is-up-to-date"><i class="fa fa-check"></i><b>19.4.1</b> Make sure your Zoom is up to date</a></li>
<li class="chapter" data-level="19.4.2" data-path="resources.html"><a href="resources.html#customize"><i class="fa fa-check"></i><b>19.4.2</b> Customize!</a></li>
<li class="chapter" data-level="19.4.3" data-path="resources.html"><a href="resources.html#vpn"><i class="fa fa-check"></i><b>19.4.3</b> VPN</a></li>
<li class="chapter" data-level="19.4.4" data-path="resources.html"><a href="resources.html#notes"><i class="fa fa-check"></i><b>19.4.4</b> Notes:</a></li>
<li class="chapter" data-level="19.4.5" data-path="resources.html"><a href="resources.html#changing-your-profile-picture-on-zoom-and-quercus"><i class="fa fa-check"></i><b>19.4.5</b> Changing your profile picture on Zoom and Quercus</a></li>
<li class="chapter" data-level="19.4.6" data-path="resources.html"><a href="resources.html#what-to-do-if-you-experience-technical-difficulties-during-class"><i class="fa fa-check"></i><b>19.4.6</b> What to do if you experience technical difficulties during class?</a></li>
<li class="chapter" data-level="19.4.7" data-path="resources.html"><a href="resources.html#what-to-do-if-your-instructor-or-ta-is-experiencing-technical-difficulties-on-zoom"><i class="fa fa-check"></i><b>19.4.7</b> What to do if your instructor or TA is experiencing technical difficulties on Zoom</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="resources.html"><a href="resources.html#student-support-services-and-resources"><i class="fa fa-check"></i><b>19.5</b> Student support services and resources</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="resources.html"><a href="resources.html#mental-health-support"><i class="fa fa-check"></i><b>19.5.1</b> Mental health support</a></li>
<li class="chapter" data-level="19.5.2" data-path="resources.html"><a href="resources.html#general-university-resources"><i class="fa fa-check"></i><b>19.5.2</b> General University resources</a></li>
<li class="chapter" data-level="19.5.3" data-path="resources.html"><a href="resources.html#financial-support"><i class="fa fa-check"></i><b>19.5.3</b> Financial support</a></li>
<li class="chapter" data-level="19.5.4" data-path="resources.html"><a href="resources.html#arts-science-covid19-faq"><i class="fa fa-check"></i><b>19.5.4</b> Arts &amp; Science COVID19 FAQ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html"><i class="fa fa-check"></i><b>20</b> FAQs and Errata</a>
<ul>
<li class="chapter" data-level="20.1" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#frequently-asked-questions"><i class="fa fa-check"></i><b>20.1</b> Frequently asked questions</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#course-admin"><i class="fa fa-check"></i><b>20.1.1</b> Course admin</a></li>
<li class="chapter" data-level="20.1.2" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#assessments-faq"><i class="fa fa-check"></i><b>20.1.2</b> Assessments FAQ</a></li>
<li class="chapter" data-level="20.1.3" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#team-up-1"><i class="fa fa-check"></i><b>20.1.3</b> Team Up!</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#other"><i class="fa fa-check"></i><b>20.2</b> Other</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#references-3"><i class="fa fa-check"></i><b>20.2.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="faqs-and-errata.html"><a href="faqs-and-errata.html#errata"><i class="fa fa-check"></i><b>20.3</b> Errata</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html"><i class="fa fa-check"></i><b>21</b> Bits and pieces</a>
<ul>
<li class="chapter" data-level="21.1" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#code-to-generate-course-art"><i class="fa fa-check"></i><b>21.1</b> Code to generate course art</a></li>
<li class="chapter" data-level="21.2" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#matrices"><i class="fa fa-check"></i><b>21.2</b> M1 supporting information on matrices (not assessed)</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#background-1"><i class="fa fa-check"></i><b>21.2.1</b> Background</a></li>
<li class="chapter" data-level="21.2.2" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#example-4"><i class="fa fa-check"></i><b>21.2.2</b> Example</a></li>
<li class="chapter" data-level="21.2.3" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#regression-not-classic-actually-anova-no-intercept"><i class="fa fa-check"></i><b>21.2.3</b> Regression NOT classic, actually ANOVA! (no intercept)</a></li>
<li class="chapter" data-level="21.2.4" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#further-reading-if-you-want-it"><i class="fa fa-check"></i><b>21.2.4</b> Further reading (if you want it)</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#p-values-recap"><i class="fa fa-check"></i><b>21.3</b> <em>p</em> values (recap)</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="bits-and-pieces.html"><a href="bits-and-pieces.html#what-if-you-get-a-value-that-is-exactly-one-of-these-thresholds"><i class="fa fa-check"></i><b>21.3.1</b> What if you get a value that is exactly one of these thresholds?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="announcements-summary.html"><a href="announcements-summary.html"><i class="fa fa-check"></i><b>22</b> Announcements summary</a>
<ul>
<li class="chapter" data-level="22.0.1" data-path="announcements-summary.html"><a href="announcements-summary.html#studentrep"><i class="fa fa-check"></i><b>22.0.1</b> Looking for student representatives for STA303</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.statistics.utoronto.ca/" target="blank">Department of Statistical Sciences, The University of Toronto</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STA303: Methods of Data Analysis II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="m3" class="section level1" number="16">
<h1><span class="header-section-number">16</span> Module 3</h1>
<div class="yellowbox">
<p>Materials for February 7–February 18, 2022.</p>
</div>
<div id="learning-checklist-2" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Learning checklist</h2>
<p>By the end of this module, you should be able to:</p>
<ul>
<li>Describe grouping structures for correlated data.</li>
<li>Discuss partitioning of sources of variability in mixed models.</li>
<li>Identify situations where linear mixed models may be needed.</li>
<li>Create plots to explore hierarchical data.</li>
<li>Write the formula for LMMs.</li>
<li>Fit LMMs with the <code>lmer</code> function using random slopes and random intercepts, as appropriate.</li>
<li>Interpret the results of <code>lmer</code> outputs.</li>
<li>Conduct appropriate tests to compare LMMs.</li>
<li>Polish your professional writing.</li>
</ul>
</div>
<div id="introduction-3" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Introduction</h2>
<p>This module recaps a few topics you should have encountered in previous courses:
* statistical independence and correlated data,<br />
* specifically, <em>from your understanding of the context/collection of data, can you identify whether observations are likely to be independent?</em>, and<br />
* maximum likelihood/maximum likelihood estimation .</p>
<p>It also introduces an extension to regression, the <strong>linear mixed model</strong>, that uses maximum likelihood estimation to allow us to more flexibly deal with correlated data, that would violate our independence assumptions.</p>
<div id="how-deep-are-we-going-on-likelihoods" class="section level3" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> How deep are we going on likelihoods?</h3>
<p>We’ll need the concept of maximum likelihood for most of the models we’ll meet in this course. That said, <strong>proofs about MLEs are not the focus of <em>this</em> course.</strong></p>
<ul>
<li>You should have encountered the concept of likelihood in <em>STA238: Probability, Statistics and Data Analysis II</em> OR <em>STA261: Probability and Statistics II</em>.
<ul>
<li>Having taken one of these is a pre-req for STA302, which is the pre-req for STA303.</li>
</ul></li>
<li>For more depth on this important and useful topic (mathematically and/or computationally) consider taking:
<ul>
<li><em>STA355: Theory of Statistical Practice</em>, and/or</li>
<li><em>STA410: Statistical Computation</em>, and/or</li>
<li><em>STA422: Theory of Statistical Inference</em> and/or</li>
<li><em>STA452: Mathematical Statistics I</em> + <em>STA453: Mathematical Statistics II</em></li>
</ul></li>
</ul>
<p>These recommendations are based only on the calendar entries for these courses, the <a href="https://www.statistics.utoronto.ca/resources/past-courses-outlines">latest syllabi</a> of these courses are probably your best guide to what is covered.</p>
<div id="maximum-likelihood-review" class="section level4" number="16.2.1.1">
<h4><span class="header-section-number">16.2.1.1</span> Maximum likelihood review</h4>
<p><span class="math display">\[L(\theta) = f(x | \theta) \]</span>
* Likelihood helps us understand how well our model fits our data.
* Maximizing the likelihood function estimates the coefficient values for our model that make <em>the data we actually observed the most likely</em>.
* That might feel a little backwards, as you could say the chance of observing out data is 100%, because we did…observe it…but hopefully the idea of picking the coefficient estimates for our model that make our data the most likely makes some sense.</p>
</div>
<div id="properties-of-maximum-likelihood-estimators" class="section level4" number="16.2.1.2">
<h4><span class="header-section-number">16.2.1.2</span> Properties of maximum likelihood estimators</h4>
<p>For large sample sizes:</p>
<ul>
<li>Bias goes to 0 (as sample size increases)<br />
</li>
<li>Approximately minimum variance<br />
</li>
<li>Approximately normal distribution (usually)</li>
</ul>
<p>Another nice feature of MLEs are that they are ‘<strong>invariant</strong>’ under transformation. This means that if <span class="math inline">\(\hat\theta\)</span> is an MLE of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(g\)</span> is a 1-1 function, then <span class="math inline">\(g(\hat\theta)\)</span> is an MLE of <span class="math inline">\(g(\theta)\)</span>. This will come in handy in future modules when we want to transform our coefficient estimates with link functions.</p>
</div>
<div id="suggested-reading" class="section level4" number="16.2.1.3">
<h4><span class="header-section-number">16.2.1.3</span> Suggested reading</h4>
<p>As this should mostly be a recap of likelihood, this is a great article on which to practice your <a href="m1.html#previewskim">previewing and skimming strategies</a>.</p>
<p>You may want to pay special attention to the likelihood ratio test.</p>
<p><a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-beyondmost.html">Chapter 2</a> (§ 2.1–2.9) of Roback, P. &amp; Legler, J. Beyond Multiple Linear Regression. (2021). Retrieved from: <a href="https://bookdown.org/roback/bookdown-BeyondMLR/" class="uri">https://bookdown.org/roback/bookdown-BeyondMLR/</a> (Links to an external site.)</p>
</div>
</div>
<div id="model-comparison-more-generally" class="section level3" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Model comparison more generally</h3>
<p><em>Thank you to TA Ian for developing this section! He applies statistics in his own research in ecology.</em></p>
<ul>
<li><p>Model selection is a key component of the development of any statistical model. In model development, there may be multiple plausible hypotheses that can be evaluated simultaneously by parameterizing different models with the same data. These candidate models can differ in both fixed and random effects however the models generally have a similar structure (e.g., multiple combinations of a set of fixed effects). To test the hypotheses with the candidate models, one must determine and compare the support for each model to determine which model(s) fit the observed data the best. While the likelihood-ratio test is suitable when comparing two models to one another, there are certain situations when the goal is to compare multiple (&gt; 2) models to identify the model that best fits the data.</p></li>
<li><p>There are many different criteria for model selection that can be used. Measures such as Akaike Information Criterion (AIC), adjusted <span class="math inline">\(R^2\)</span>, and the Bayesian Information Criterion (BIC) measure the goodness of fit of the model to the data whereas others are focused on calculating the predictive performance of the model (e.g., prediction error rate, root mean square error). Model selection criteria focus on model fit however some will also consider model complexity as model fit generally increases with an increase in the number of model parameters. The selection of the appropriate criteria is generally dependent on the type of model and the purpose of model development (i.e. inference or prediction).</p></li>
<li><p>For this course, we will use likelihood ratio tests as well as the information-theoretic (I-T) approach using AIC for model selection. AIC measures the lack of model fit to the data based on the log-likelihood of the model while penalizing for the number of parameters in the model. Lower AIC values indicate that the model strongly fits the observed data whereas a higher value indicates a poor model fit. <strong>The absolute AIC values can be challenging to interpret</strong> so the values are compared relative to one another. Among the candidate models, identify the lowest AIC value (<span class="math inline">\(AIC_{min}\)</span>}) and calculate the differences between <span class="math inline">\(AIC_{min}\)</span> and the AIC values of every candidate model (<span class="math inline">\(AIC_{i}\)</span>) to obtain AIC differences (<span class="math inline">\(\Delta\)</span>AIC) for each model. In general, large values of <span class="math inline">\(\Delta\)</span>AIC (&gt; 10) indicate no support for the model, models with intermediate values (4-7) have little support, and models with small values (0-3) have strong support. These categories are arbitrary and may differ among studies.</p></li>
<li><p>There are scenarios where multiple models have similar support and there is no considerable difference among the model selection criteria. These models would then represent plausible models and support their associated hypotheses. Additionally, model weights can be calculated to evaluate the relative support of each model by the data. Larger weights indicate that the model is strongly supported by the data whereas small values suggest the model poorly fits the data.</p></li>
</ul>
<div id="references-1" class="section level5" number="16.2.2.0.1">
<h5><span class="header-section-number">16.2.2.0.1</span> References</h5>
<p>Burnham, K. P., Anderson, D. R., &amp; Huyvaert, K. P. (2011). AIC model selection and multimodel inference in behavioral ecology: some background, observations, and comparisons. Behavioral ecology and sociobiology, 65(1), 23-35.</p>
</div>
</div>
</div>
<div id="correlated-data" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Correlated data</h2>
<div id="reading" class="section level3" number="16.3.1">
<h3><span class="header-section-number">16.3.1</span> Reading</h3>
<p><a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-corrdata.html#recognizing-correlation">Chapter 7 (§ 7.3 and 7.8) of Roback, P. &amp; Legler, J. Beyond Multiple Linear Regression. (2021). Retrieved from: https://bookdown.org/roback/bookdown-BeyondMLR/</a></p>
</div>
<div id="key-vocabulary" class="section level3" number="16.3.2">
<h3><span class="header-section-number">16.3.2</span> Key vocabulary</h3>
<ul>
<li><strong>Fixed effects</strong>: These are non-random quantities. All the coefficients you were estimating in STA302 are examples of fixed effects as you were not treating <span class="math inline">\(\beta_1\)</span> as a random variable, for example.</li>
<li><strong>Random effects</strong>: These ARE random quantities. These model parameters are treated as random variables.</li>
<li><strong>Mixed effects model</strong>: A model that includes both fixed and random effects as its parameters. These are also called hierarchical models and just mixed models. They are NOT the same as <em>mixed methods</em>, which is a ‘mix’ of <em>quantitative</em> and <em>qualitative</em> research methodology.</li>
<li><strong>Nested/nesting design</strong>: Observational units are grouped within grouping units. There may be multiple levels of grouping.</li>
<li><strong>Crossed effect design</strong>: Every observational unit experiences every level of the treatment variable.</li>
<li><strong>Observational units</strong>: The person or thing on which your outcome of interest is measured. In an experiment we might also call this the ‘experimental unit’ or some might say ‘statistical unit.’ In <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-corrdata.html#recognizing-correlation">Chapter 7 of Beyond Multiple Linear Regression</a>, these are referred to as ‘level-one observational units.’
<ul>
<li>E.g. In a survey of our class, each student is the observational unit. When I am preparing my final grades, each assessment for each student is my unit of observation. This links back to tidy data (week 2). We want each observational unit to have its own row and only that one row.</li>
</ul></li>
<li><strong>Grouping units</strong>: How your observational units are grouped together. In <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-corrdata.html#recognizing-correlation">Chapter 7 of Beyond Multiple Linear Regression</a>, these are referred to as ‘level-two observational units,’ but you could have even more levels of grouping. Groups within groups, etc.</li>
</ul>
</div>
</div>
<div id="statdew-valley-interactive" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Statdew Valley interactive</h2>
<p><a href="https://jupyter.utoronto.ca/hub/user-redirect/git-pull?repo=https%3A%2F%2Fgithub.com%2Fsta303-bolton%2Fsta303-w22-activities&amp;urlpath=shiny%2Fsta303-w22-activities%2Finst%2Ftutorials%2Fsta303_m3_statdew%2Fsta303_m3_statdew-valley.Rmd&amp;branch=master">Click this text to go to the interactive</a></p>
<p><img src="images/m3/statdewvalley.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Note: A ‘static’ version of this interactive follows, to aid review, but I recommend you work through the interactive the first time.</p>
<div id="welcome-to-statdew-valley" class="section level3" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Welcome to Statdew Valley!</h3>
<p>You’re grandmother has asked you to take over her old farm plot in <em>Statdew Valley</em>. Armed with statistical knowledge, you set out to begin your new life!</p>
<p>There are two of datasets for you to analyze to better understand the operation of your farm.</p>
<p>Note: The final ‘hint’ for code chunks will be the solution.</p>
<p></br>
</br>
</br>
</br>
<em>Yes, this is totally an homage to <a href="https://www.stardewvalley.net/">Stardew Valley</a>. Have I played? No, but à la Girlfriend Reviews on YouTube, this is based on “what it’s like to live with someone who plays Stardew Valley.”</em></p>
</div>
<div id="optional-create-your-16-bit-character" class="section level3" number="16.4.2">
<h3><span class="header-section-number">16.4.2</span> Optional: Create your 16 bit character</h3>
<p>You can use R for so much more than just running regressions! This section is <strong>totally optional</strong>, and definitely <strong>not assessed.</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Copy this code into a separate .Rmd</strong>. It won’t work from within a Shiny App (this interactive).<br />
</li>
<li>Save the .Rmd and make sure it is in a folder, not in your Home directory. Rmd files in your Home directory will cause interactives to fail.</li>
<li>Choose an image to pixelate to get your character. You’ll need to have a URL for it (or you could edit the code for a local file). I think it is easiest to upload to GitHub (or Google Photos) and then right click to copy the image address.</li>
<li>Play with the Shiny app interface for the pixelart package to help you get the settings right.</li>
<li>Update these settings in the code below.</li>
<li>[Super super optional] Post your character on the <a href="https://q.utoronto.ca/courses/253305/discussion_topics/1616645">optional discussion board for this week</a>. If you have a Stardew Valley character or some other pixel art of yourself, you can share that, too. This is just for fun, no requirement to participate. Please be sensible about making sure any images are <em>appropriate.</em> Don’t use images of other people, etc.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="m3.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install pixel art</span></span>
<span id="cb43-2"><a href="m3.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># More info: https://privefl.github.io/pixelart</span></span>
<span id="cb43-3"><a href="m3.html#cb43-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;privefl/pixelart&quot;</span>)</span>
<span id="cb43-4"><a href="m3.html#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="m3.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Install tidyverse if you haven&#39;t</span></span>
<span id="cb43-6"><a href="m3.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb43-7"><a href="m3.html#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="m3.html#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Install magick if you haven&#39;t</span></span>
<span id="cb43-9"><a href="m3.html#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;magick&quot;)</span></span>
<span id="cb43-10"><a href="m3.html#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="m3.html#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb43-12"><a href="m3.html#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pixelart)</span>
<span id="cb43-13"><a href="m3.html#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-14"><a href="m3.html#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="m3.html#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Upload a profile picture of yourself to GitHub or another service where you can then get the image address. With GitHub, you&#39;ll need to add ?raw=TRUE to the end of the URL (it is also what you get if you right click and select &#39;Copy Image Address&#39; )</span></span>
<span id="cb43-16"><a href="m3.html#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="m3.html#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Here is an example of mine</span></span>
<span id="cb43-18"><a href="m3.html#cb43-18" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&quot;https://github.com/sta303-bolton/other/blob/main/lb-for-statdew-valley.png?raw=true&quot;</span></span>
<span id="cb43-19"><a href="m3.html#cb43-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-20"><a href="m3.html#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Shiny app for pixel art models</span></span>
<span id="cb43-21"><a href="m3.html#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># This should open in a new browser window</span></span>
<span id="cb43-22"><a href="m3.html#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># You can use it to play around with the settings and once you&#39;re mostly happy, update the settings below based on them</span></span>
<span id="cb43-23"><a href="m3.html#cb43-23" aria-hidden="true" tabindex="-1"></a>pixelart<span class="sc">::</span><span class="fu">run_pixelart</span>()</span>
<span id="cb43-24"><a href="m3.html#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="m3.html#cb43-25" aria-hidden="true" tabindex="-1"></a>url <span class="ot">=</span> <span class="st">&quot;https://github.com/sta303-bolton/other/blob/main/lb-for-statdew-valley.png?raw=true&quot;</span></span>
<span id="cb43-26"><a href="m3.html#cb43-26" aria-hidden="true" tabindex="-1"></a>resize1 <span class="ot">=</span> <span class="dv">300</span></span>
<span id="cb43-27"><a href="m3.html#cb43-27" aria-hidden="true" tabindex="-1"></a>resize2 <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb43-28"><a href="m3.html#cb43-28" aria-hidden="true" tabindex="-1"></a>ncolors <span class="ot">=</span> <span class="dv">15</span></span>
<span id="cb43-29"><a href="m3.html#cb43-29" aria-hidden="true" tabindex="-1"></a>color_bg <span class="ot">=</span> <span class="st">&quot;#FFFFFF&quot;</span></span>
<span id="cb43-30"><a href="m3.html#cb43-30" aria-hidden="true" tabindex="-1"></a>saturation <span class="ot">=</span> <span class="dv">70</span></span>
<span id="cb43-31"><a href="m3.html#cb43-31" aria-hidden="true" tabindex="-1"></a>degrees <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb43-32"><a href="m3.html#cb43-32" aria-hidden="true" tabindex="-1"></a>left <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb43-33"><a href="m3.html#cb43-33" aria-hidden="true" tabindex="-1"></a>top <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb43-34"><a href="m3.html#cb43-34" aria-hidden="true" tabindex="-1"></a>right <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb43-35"><a href="m3.html#cb43-35" aria-hidden="true" tabindex="-1"></a>bottom <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb43-36"><a href="m3.html#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="m3.html#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="m3.html#cb43-38" aria-hidden="true" tabindex="-1"></a><span class="co"># I made some changes to the plot_color_matrix function in the pixel art package to produce the look I wanted</span></span>
<span id="cb43-39"><a href="m3.html#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Most of this code is the same as from that package. Credit to: Florian Privé, author and creator of the package. </span></span>
<span id="cb43-40"><a href="m3.html#cb43-40" aria-hidden="true" tabindex="-1"></a>plot_color_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(raster){</span>
<span id="cb43-41"><a href="m3.html#cb43-41" aria-hidden="true" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(raster))</span>
<span id="cb43-42"><a href="m3.html#cb43-42" aria-hidden="true" tabindex="-1"></a>    cols <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">ncol</span>(raster))</span>
<span id="cb43-43"><a href="m3.html#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="at">y =</span> <span class="fu">rev</span>(cols), <span class="at">x =</span> rows), <span class="fu">expand.grid</span>(<span class="at">color =</span> <span class="fu">t</span>(raster), </span>
<span id="cb43-44"><a href="m3.html#cb43-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes_string</span>(<span class="st">&quot;x&quot;</span>, </span>
<span id="cb43-45"><a href="m3.html#cb43-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;y&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;I(color)&quot;</span>)) <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb43-46"><a href="m3.html#cb43-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-47"><a href="m3.html#cb43-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-48"><a href="m3.html#cb43-48" aria-hidden="true" tabindex="-1"></a>im0 <span class="ot">&lt;-</span> url <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_read</span>() <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_background</span>(color_bg) <span class="sc">%&gt;%</span> </span>
<span id="cb43-49"><a href="m3.html#cb43-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">crop</span>(<span class="at">left =</span> left, <span class="at">right =</span> right, <span class="at">bottom =</span> bottom, <span class="at">top =</span> top) <span class="sc">%&gt;%</span> </span>
<span id="cb43-50"><a href="m3.html#cb43-50" aria-hidden="true" tabindex="-1"></a>        magick<span class="sc">::</span><span class="fu">image_rotate</span>(degrees) <span class="sc">%&gt;%</span> magick<span class="sc">::</span><span class="fu">image_modulate</span>(<span class="at">saturation =</span> <span class="dv">120</span>)</span>
<span id="cb43-51"><a href="m3.html#cb43-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-52"><a href="m3.html#cb43-52" aria-hidden="true" tabindex="-1"></a>im1 <span class="ot">&lt;-</span> <span class="fu">downsize</span>(im0, resize1)</span>
<span id="cb43-53"><a href="m3.html#cb43-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-54"><a href="m3.html#cb43-54" aria-hidden="true" tabindex="-1"></a><span class="co"># this can take a while to run</span></span>
<span id="cb43-55"><a href="m3.html#cb43-55" aria-hidden="true" tabindex="-1"></a>kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans_colors</span>(im1, ncolors)</span>
<span id="cb43-56"><a href="m3.html#cb43-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-57"><a href="m3.html#cb43-57" aria-hidden="true" tabindex="-1"></a>im2 <span class="ot">&lt;-</span> <span class="fu">downsize</span>(im0, resize2)</span>
<span id="cb43-58"><a href="m3.html#cb43-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-59"><a href="m3.html#cb43-59" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_color_matrix</span>(<span class="fu">colors_kmeans</span>(im2, kmeans))</span></code></pre></div>
<p><img src="images/m3/lb-for-statdew-valley.png" width="25%" style="display: block; margin: auto;" /></p>
<p><img src="images/m3/lb-example.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Is this GOOD character pixel art? No. But I think it is cool that you can do image manipulation in R!</p>
</div>
<div id="task-1-tomatoes-part-1" class="section level3" number="16.4.3">
<h3><span class="header-section-number">16.4.3</span> Task 1: Tomatoes (part 1)</h3>
<p>Suppose your farm has a small experimental tomato patch. You are interested in knowing if there is any difference between the weight of tomatoes produced from plants that are fertilized with basic fertilizer vs tomatoes produced from plants that are fertilized with quality fertilizer.</p>
<p>Tee patch has two plots, one for each fertilizer type. In each plot there are three tomato plants (all of the same species). Other growth influencing factors, like light exposure and precipitation are the same for each plot.</p>
<p>4 tomatoes were chosen at random from each plant and weighed (reported in grams). This data is stored in <code>tomatoes</code>.</p>
<p><img src="images/m3/tomatoplot.png" width="100%" style="display: block; margin: auto;" />
<em>Layout of tomato patch</em></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="m3.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tomatoes)</span></code></pre></div>
<pre><code>## Rows: 24
## Columns: 3
## $ plant      &lt;int&gt; 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5,…
## $ fertilizer &lt;chr&gt; &quot;basic&quot;, &quot;basic&quot;, &quot;basic&quot;, &quot;basic&quot;, &quot;basic&quot;, &quot;basic&quot;, &quot;basi…
## $ weight     &lt;dbl&gt; 123.0, 124.0, 128.0, 125.0, 135.0, 140.0, 129.0, 131.0, 146…</code></pre>
<div id="plot-the-tomat-ah-dat-ah" class="section level4" number="16.4.3.1">
<h4><span class="header-section-number">16.4.3.1</span> Plot the tomat-ah dat-ah</h4>
<p>Create a plot with <code>plant</code> on the x axis, <code>weight</code> on the y axis and coloured by <code>fertilizer</code> type. Choose a sensible geometry. I also used <code>theme_minimal()</code> because I like the way it looks. This is just an exploratory plot for our benefit, so it can be a bit rough. No title, etc.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="m3.html#cb46-1" aria-hidden="true" tabindex="-1"></a>tomatoes <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="m3.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> plant, <span class="at">y =</span> weight, <span class="at">colour =</span> fertilizer)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="m3.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="m3.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="STA303-Course-guide_files/figure-html/tom_plot-solution-1.png" width="672" /></p>
<p><em>Note: We’re going to take a pretty STA302 approach here. We’ll start out by doing something WRONG and then improve it in the next section, still under the least squares framework. We can do this BECAUSE this is what is called a ‘balanced data’ design. That is, there is an equal number of observations in each combination of levels: 4 tomatoes per plant per fertilizer type plot.</em></p>
</div>
<div id="the-wrong-approach-fixed-effects-only" class="section level4" number="16.4.3.2">
<h4><span class="header-section-number">16.4.3.2</span> The WRONG approach: fixed effects only</h4>
<p><strong>Fertilizer is our variable of interest</strong>, so we need to include it in the model, but we might expect that tomatoes from the same plant are more similar to each other in weight than tomatoes from different plants. This also seems believable based on the plot. So, let’s start by proposing a model like this:</p>
<div id="model" class="section level5" number="16.4.3.2.1">
<h5><span class="header-section-number">16.4.3.2.1</span> Model</h5>
<p><span class="math display">\[y_{i} = \alpha_j + \beta_k + \epsilon_{i}  \]</span></p>
<p>where <span class="math inline">\(y_{i}\)</span> is the weight of the <span class="math inline">\(i^{th}\)</span> tomato from plant <span class="math inline">\(k\)</span> in fertilizer plot <span class="math inline">\(j\)</span>. Here, <span class="math inline">\(\alpha_j\)</span> is the population mean weight for fertilizer plot <span class="math inline">\(j\)</span> and <span class="math inline">\(\beta_k\)</span> is the difference of plant <span class="math inline">\(k\)</span> from that mean.</p>
<p>The two longer horizontal lines in this graph represent <span class="math inline">\(\alpha_{basic}\)</span> and <span class="math inline">\(\alpha_{quality}\)</span> respectively. Each plant also has a shorter horizontal line shown which represents the mean weight of tomatoes from that plant. The distances (shown with the 6 vertical lines) are the <span class="math inline">\(\beta\)</span> values discussed above. (You’re not required to be able to create this plot right now. If you’re curious you can see the code in the .Rmd version of this activity.)</p>
<div class="figure"><span id="fig:unnamed-chunk-86"></span>
<img src="STA303-Course-guide_files/figure-html/unnamed-chunk-86-1.png" alt="*Figure: Visual representation of the equation for this data*" width="672" />
<p class="caption">
Figure 16.1: <em>Figure: Visual representation of the equation for this data</em>
</p>
</div>
<p>Now, this probably looks a little different to how you’ve been writing models, but I hope it makes sense as describing the data that we’re interested in.</p>
<p><strong>Question: Could we use this model to predict the average weight of tomatoes from a new plant (e.g. plant 7) grown in the quality fertilizer?</strong></p>
<p>Answer: No We have no coefficient for plant 7, so no, this model as it is currently won’t help us make predictions for any plants other than the ones we’ve observed."</p>
<p><strong>Question: Is this model identifiable as currently set out? That is, is there only one possible set of values that we could set these parameters to to get the correct response value?</strong></p>
<p>Answer: No. The <span class="math inline">\(\beta_k\)</span> s are completely nested within our fertilizer levels, with three plants in the ‘basic’ fertilizer plot and three in the ‘quality fertilizer plot.’ Why is the a problem? In trying to fit these values, you’ll end up with an infinite number of possible values, because you can add any value to <span class="math inline">\(\alpha_{basic}\)</span> and subtract the same value from <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span> and <span class="math inline">\(\beta_3\)</span> to get the same value of <span class="math inline">\(y\)</span>. (Likewise for the ‘quality’ fertilizer plot and associated plants). Our model conceptualized in this way will not be identifiable."</p>
</div>
</div>
<div id="lets-try-some-models-part-1" class="section level4" number="16.4.3.3">
<h4><span class="header-section-number">16.4.3.3</span> Let’s try some models: Part 1</h4>
<ol style="list-style-type: decimal">
<li>Fit a model called <code>tom1</code> with <code>weight</code> as the outcome and <code>fertilizer</code> and <code>plant</code> as the predictors. Make sure <code>plant</code> is treated as a categorical (factor) variable, not numeric.</li>
<li>Fit a model called <code>tom2</code> with <code>weight</code> as the outcome and and just <code>fertilizer</code> as the predictor.</li>
<li>Compare these models using ANOVA.</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="m3.html#cb47-1" aria-hidden="true" tabindex="-1"></a>tom1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> <span class="fu">as_factor</span>(plant) <span class="sc">+</span> fertilizer, <span class="at">data =</span> tomatoes)</span>
<span id="cb47-2"><a href="m3.html#cb47-2" aria-hidden="true" tabindex="-1"></a>tom2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> fertilizer, <span class="at">data =</span> tomatoes)</span>
<span id="cb47-3"><a href="m3.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(tom1, tom2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: weight ~ as_factor(plant) + fertilizer
## Model 2: weight ~ fertilizer
##   Res.Df     RSS Df Sum of Sq      F   Pr(&gt;F)    
## 1     18  411.62                                 
## 2     22 2192.29 -4   -1780.7 19.467 2.41e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="m3.html#cb49-1" aria-hidden="true" tabindex="-1"></a>result_tom1 <span class="ot">&lt;-</span> <span class="fu">anova</span>(<span class="fu">lm</span>(weight <span class="sc">~</span> <span class="fu">as_factor</span>(plant) <span class="sc">+</span> fertilizer, <span class="at">data =</span> tomatoes),  <span class="fu">lm</span>(weight <span class="sc">~</span> fertilizer, <span class="at">data =</span> tomatoes))</span>
<span id="cb49-2"><a href="m3.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="m3.html#cb49-3" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2e&quot;</span>, result_tom1<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">2</span>])</span></code></pre></div>
<p><strong>Question: Is there any evidence against the hypothesis that a model with fertilizer alone fits the data as well as the model with both plant and fertilizer?</strong></p>
<p>A. “Yes, we have evidence against the fertilizer only model being just as good.<br />
B.”No, we can proceed with the fertilizer only model.</p>
<p>Answer: The p-value from our ANOVA above, 2.41e-06, suggests that there is strong evidence against there being no plant effect. Which means that we can’t separate whether the fertilizer is having an effect or not, with this model.</p>
<p>To emphasize the problem further, let’s fit another model</p>
<ol style="list-style-type: decimal">
<li>Fit <code>tom3</code>, that predicts <code>weight</code> with <code>plant</code> (as a factor) as the only independent variable.</li>
<li>Run an anova to compare <code>tom1</code> and <code>tom3</code></li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="m3.html#cb50-1" aria-hidden="true" tabindex="-1"></a>tom1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> <span class="fu">as_factor</span>(plant) <span class="sc">+</span> fertilizer, <span class="at">data =</span> tomatoes)</span>
<span id="cb50-2"><a href="m3.html#cb50-2" aria-hidden="true" tabindex="-1"></a>tom3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> <span class="fu">as_factor</span>(plant), <span class="at">data =</span> tomatoes)</span>
<span id="cb50-3"><a href="m3.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(tom1, tom3)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: weight ~ as_factor(plant) + fertilizer
## Model 2: weight ~ as_factor(plant)
##   Res.Df    RSS Df Sum of Sq F Pr(&gt;F)
## 1     18 411.62                      
## 2     18 411.62  0         0</code></pre>
<p><strong>Question: Think carefully about <code>tom1</code> and <code>tom3.</code> Which ONE of the following statements is TRUE based on the results of your ANOVA, above?</strong></p>
<p>A. We have very strong evidence against the claim that the plant only model fits the data as well as the model with plant and fertilizer.<br />
B. We have no evidence against the claim that the plant only model fits the data as well as the model with plant and fertilizer, and so it appears there isn’t a difference between the fertilizers.
C. Because of the nesting of plant within fertilizer, these models are actually really the SAME model and comparing them tells us nothing about the fertilizer.</p>
<p>Answer: C. These models actually are the SAME in terms of the information they have, because of the total nesting of plants within fertilizer plots. You’ll notice the residual degrees of freedom are the same. So it is true that comparing them tells us nothing about fertilizer effects.</p>
</div>
<div id="summary" class="section level4" number="16.4.3.4">
<h4><span class="header-section-number">16.4.3.4</span> Summary</h4>
<p>Approaching our model in this way has several problems.</p>
<ul>
<li>Our model isn’t <strong>identifiable.</strong> In fact, if you run <code>summary(tom1)</code>, you’ll see that the fertilizer coefficient is NA because of this! Oops.</li>
<li>What we can model isn’t that useful to us, because it doesn’t <strong>generalize</strong> to any new plants. (E.g., we can’t say anything about a plant 7.)</li>
<li>If we just fit the model is fertilizer, we know our <strong>independence assumption</strong> is violated and don’t know how much of a problem that will be for us. (Violated because we know observational units, tomatoes, are not independent when they come from the same plant.)</li>
</ul>
<p>So, do we give up on our first farming task?</p>
<p>Nope!</p>
</div>
</div>
<div id="task-1-tomatoes-part-2" class="section level3" number="16.4.4">
<h3><span class="header-section-number">16.4.4</span> Task 1: Tomatoes (part 2)</h3>
<div id="the-right-approach-mixed-effects" class="section level4" number="16.4.4.1">
<h4><span class="header-section-number">16.4.4.1</span> The RIGHT approach: mixed effects</h4>
<p>To approach this problem better, let us take a step back and realize that we really want to treat <code>fertilizer</code> and <code>plant</code> <strong><em>differently</em></strong>. Fertilizer is a classic <em>fixed effect</em> kind of variable. We want to be able to treat the parameter as fixed and we want to be able to use it to generalize so we can make claims about whether or not there is a difference between the fertilizers. Meanwhile, we’re not <em>really</em> that interested in the effects of each of these plants. We want information that will help us make decisions for future plants. What if we plant 20 new tomato plants? We want to be able make data driven claims in that case, too, not just for these 6 plants. BUT we also can’t ignore the plant effects (independence assumption, as discussed).</p>
<p>Our solution? <strong>Treat plant effect as a random variable</strong>. We can think of these 6 plants as drawn from the population of all tomato plants (of this species, in these conditions). We can then understand each of their effects as an independent observation from this distribution.</p>
<p><strong>Decision: We will model <code>fertilizer</code> as a fixed effect and <code>plant</code> as a random effect.</strong></p>
<div id="model-1" class="section level5" number="16.4.4.1.1">
<h5><span class="header-section-number">16.4.4.1.1</span> Model</h5>
<p>This looks like:
<span class="math display">\[ y_i = \alpha_j + b_k + \epsilon_i\]</span></p>
<p>where, again, <span class="math inline">\(y_{i}\)</span> is the weight of the <span class="math inline">\(i^{th}\)</span> tomato from plant <span class="math inline">\(k\)</span> in fertilizer plot <span class="math inline">\(j\)</span>. Here, <span class="math inline">\(\alpha_j\)</span> is again the population mean weight for fertilizer plot <span class="math inline">\(j\)</span> BUT <span class="math inline">\(b_k \sim N(0, \sigma_b^2)\)</span> and <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>. <span class="math inline">\(b_k\)</span> and <span class="math inline">\(\epsilon_i\)</span> are mutually independent.</p>
<p>Because we’re in ‘statistical easy mode’ (balanced design) with this example, we can actually achieve all of this in the framework of ordinary least squares you learned in STA302. FIRST we have to do some data manipulation.</p>
<p><strong>Question: Can you guess what we need to do to our data?</strong></p>
<p>A. Calculate average weight by fertilizer type and refit with formula <code>weight_avg ~ plant</code><br />
B. Calculate average weight by plant and refit with formula <code>weight_avg ~ fertilizer</code><br />
C. Calculate average weight by plant and fertilizer and refit with formula <code>weight_avg ~ 1</code></p>
<p>Answer: We want to aggregate the data such that we have one value for each plant, the average weight of tomatoes from that plant. Then we will fit the model with the formula <code>weight_avg ~ fertilizer</code>.</p>
<ol style="list-style-type: decimal">
<li>Create a new dataset called <code>tom_agg</code> from the <code>tomatoes</code> dataset.</li>
<li>Group by both fertilizer and plant. Because plant is fully nested in fertilizer, this is just a convenient way to keep the fertilizer variable in the dataset.</li>
<li>Summarize so you get the mean tomato weight for each plant. Call this variable <code>weight_avg</code>.</li>
<li>Run <code>glimpse(tom_agg)</code>.</li>
</ol>
<p><strong>Before you run the code, see if you can predict what the output should look based on these instructions.</strong></p>
<p><strong>Question: What will the new <code>tom_agg</code> data set look like?</strong></p>
<p>A. There will be one row for each plant, so 6 rows total. Three columns, for fertilizer, plant and weight_avg.", correct = TRUE),
B. There will be one row for each plant and fertilizer combination, so 2*6 = 12 rows total. Three columns, for fertilizer, plant and weight_avg.“),
C. There will still be 24 rows and the original three columns, but now there will be an additional <code>weight_avg</code> column.”),
D. We can’t predict how many rows there will be, but there should be 3 columns.</p>
<p>Answer: Run the code and see! (or see below)</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="m3.html#cb52-1" aria-hidden="true" tabindex="-1"></a>tom_agg <span class="ot">&lt;-</span> tomatoes <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="m3.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fertilizer, plant) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="m3.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight_avg =</span> <span class="fu">mean</span>(weight), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb52-4"><a href="m3.html#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="m3.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tom_agg)</span></code></pre></div>
<pre><code>## Rows: 6
## Columns: 3
## $ fertilizer &lt;chr&gt; &quot;basic&quot;, &quot;basic&quot;, &quot;basic&quot;, &quot;quality&quot;, &quot;quality&quot;, &quot;quality&quot;
## $ plant      &lt;int&gt; 1, 2, 3, 4, 5, 6
## $ weight_avg &lt;dbl&gt; 125.000, 133.750, 144.125, 140.375, 162.500, 156.500</code></pre>
<p>Now that you’ve created the new appropriately aggregated dataset, <code>tom_agg</code>, use it to fit a model called <code>tom_final</code> that predicts <code>weight_avg</code> from <code>fertilizer</code>. Then run <code>summary()</code> on it. Calculate a 95% confidence interval for the effect of using quality fertilizer over basic fertilizer.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="m3.html#cb54-1" aria-hidden="true" tabindex="-1"></a>tom_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_avg <span class="sc">~</span> fertilizer, <span class="at">data =</span> tom_agg)</span>
<span id="cb54-2"><a href="m3.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tom_final)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight_avg ~ fertilizer, data = tom_agg)
## 
## Residuals:
##        1        2        3        4        5        6 
##  -9.2917  -0.5417   9.8333 -12.7500   9.3750   3.3750 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        134.292      6.091  22.048  2.5e-05 ***
## fertilizerquality   18.833      8.614   2.186   0.0941 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.55 on 4 degrees of freedom
## Multiple R-squared:  0.5445, Adjusted R-squared:  0.4306 
## F-statistic: 4.781 on 1 and 4 DF,  p-value: 0.09406</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="m3.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(tom_final)</span></code></pre></div>
<pre><code>##                        2.5 %    97.5 %
## (Intercept)       117.381037 151.20230
## fertilizerquality  -5.081909  42.74858</code></pre>
<p><strong>Question: Which one of the following statements about our results is correct?</strong></p>
<p>A. We have weak evidence against the claim that fertilizer type has no effect on tomato weight.<br />
B. It is plausible, at the 95% confidence level, that on average, quality fertilizer produces tomatoes that are 10 grams heavier than tomatoes grown in basic fertilizer.<br />
C. At the 5% significance level we fail to reject the hypothesis that the average weight of tomatoes grown each fertilizer type is the same.<br />
D. Using a 5% significance level here, there is a chance that we are making a type II error.<br />
E. More than one of the above.</p>
<p>Answer: All of these are actually correct! A) If using a ‘strength’ approach instead of a reject/fail to reject one, we often say a p-value between 0.1 and 0.05 is ‘weak evidence.’ B) 10 is in our 95% confidence interval, so it is a ‘plausible’ or believable value, because a CI is a range of plausible values for our parameter. C) Our p-value is larger than 0.05, so we fail to reject it at the 5% level. D) Because we are failing to reject the null, there is a chance that we’re wrong, and we SHOULD have rejected the null. Failing to reject the null when you should is a type II error. I remember this with ‘fail <strong>2</strong> reject -&gt; type <strong>2</strong>’</p>
</div>
</div>
<div id="variance-of-our-random-effect" class="section level4" number="16.4.4.2">
<h4><span class="header-section-number">16.4.4.2</span> Variance of our random effect</h4>
<p>When we are conducting mixed effects models, we’re often interested in the variability of our random effects. So, we want to estimate <span class="math inline">\(\sigma_b^2\)</span> from the model above.</p>
<p>Firstly, we can think about what variability that isn’t explained by our fixed effects. This is our <em>residual</em> variance. We get this from squaring the residual standard error in <code>tom_final</code>. This value is actually partitioned into two independent sources of variability, <span class="math inline">\(\hat{\sigma}^2\)</span>, the variance of our random error, and <span class="math inline">\(\hat{\sigma_b}^2\)</span>, the variance of our random effect.</p>
<p>While you can derive this yourself if you like, let’s also take as true the following:
<span class="math display">\[\frac{\text{RSS}_{tom\_final}}{4} = \hat{\sigma_b}^2 + \frac{\hat{\sigma}^2}{4} \]</span>.</p>
<p>The following just reruns the final code from the tasks above so I can use it.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="m3.html#cb58-1" aria-hidden="true" tabindex="-1"></a>tom_agg <span class="ot">&lt;-</span> tomatoes <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="m3.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fertilizer, plant) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="m3.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight_avg =</span> <span class="fu">mean</span>(weight), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb58-4"><a href="m3.html#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="m3.html#cb58-5" aria-hidden="true" tabindex="-1"></a>tom_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight_avg <span class="sc">~</span> fertilizer, <span class="at">data =</span> tom_agg)</span>
<span id="cb58-6"><a href="m3.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tom_final)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight_avg ~ fertilizer, data = tom_agg)
## 
## Residuals:
##        1        2        3        4        5        6 
##  -9.2917  -0.5417   9.8333 -12.7500   9.3750   3.3750 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        134.292      6.091  22.048  2.5e-05 ***
## fertilizerquality   18.833      8.614   2.186   0.0941 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.55 on 4 degrees of freedom
## Multiple R-squared:  0.5445, Adjusted R-squared:  0.4306 
## F-statistic: 4.781 on 1 and 4 DF,  p-value: 0.09406</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="m3.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE and square it</span></span>
<span id="cb60-2"><a href="m3.html#cb60-2" aria-hidden="true" tabindex="-1"></a>overall_var <span class="ot">&lt;-</span> <span class="fu">summary</span>(tom_final)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb60-3"><a href="m3.html#cb60-3" aria-hidden="true" tabindex="-1"></a>overall_var</span></code></pre></div>
<pre><code>## [1] 111.2917</code></pre>
<p>Secondly, we actually have an estimate of <span class="math inline">\(\hat{\sigma}^2\)</span> from the model we fit right at the beginning, <code>tom1</code>. This is the variance we can’t account for even after fitting both <code>plant</code> and <code>fertilizer</code> as fixed effects.</p>
<p><span class="math inline">\(\hat{\sigma}^2 = \frac{\text{RSS}_{tom1}}{\text{DF}_{tom1}}\)</span></p>
<p>(This is just from our usual linear model theory. <span class="math inline">\(\hat{\sigma} = \text{RSE} = \sqrt{\frac{\text{RSS}}{DF}}\)</span>, so <span class="math inline">\(\hat{\sigma}^2 = \text{RSE}^2 = \frac{\text{RSS}}{DF}\)</span>)</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="m3.html#cb62-1" aria-hidden="true" tabindex="-1"></a>tom1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> <span class="fu">as.factor</span>(plant) <span class="sc">+</span> fertilizer, <span class="at">data =</span> tomatoes)</span>
<span id="cb62-2"><a href="m3.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tom1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ as.factor(plant) + fertilizer, data = tomatoes)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.500 -2.938 -1.062  2.156  9.625 
## 
## Coefficients: (1 not defined because of singularities)
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        125.000      2.391  52.279  &lt; 2e-16 ***
## as.factor(plant)2    8.750      3.381   2.588  0.01857 *  
## as.factor(plant)3   19.125      3.381   5.656 2.30e-05 ***
## as.factor(plant)4   15.375      3.381   4.547  0.00025 ***
## as.factor(plant)5   37.500      3.381  11.090 1.78e-09 ***
## as.factor(plant)6   31.500      3.381   9.316 2.63e-08 ***
## fertilizerquality       NA         NA      NA       NA    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.782 on 18 degrees of freedom
## Multiple R-squared:  0.9047, Adjusted R-squared:  0.8783 
## F-statistic: 34.19 on 5 and 18 DF,  p-value: 1.395e-08</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="m3.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the RSE and square it</span></span>
<span id="cb64-2"><a href="m3.html#cb64-2" aria-hidden="true" tabindex="-1"></a>error_var <span class="ot">&lt;-</span> <span class="fu">summary</span>(tom1)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb64-3"><a href="m3.html#cb64-3" aria-hidden="true" tabindex="-1"></a>error_var</span></code></pre></div>
<pre><code>## [1] 22.86806</code></pre>
<p>The unexplained variability in our final model can be partitioned into the plant-to-plant variability and the random error variability. The random error variance is divided by the degrees of freedom of the final model.</p>
<p><span class="math display">\[\text{RSE}_{tom\_final}^2 = \frac{\text{RSS}_{tom\_final}}{4} = \hat{\sigma_b}^2 +  \frac{\hat{\sigma}^2}{4}\]</span></p>
<p><span class="math display">\[ = \hat{\sigma_b}^2 + \frac{\text{RSS}_{tom1}}{18}\cdot\frac{1}{4}\]</span></p>
<p><span class="math display">\[\hat{\sigma_b}^2 = \text{RSE}_{tom\_final}^2 - \text{RSE}^2_{tom1} \cdot\frac{1}{4}\]</span></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="m3.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s calculate the variance of the plant effect</span></span>
<span id="cb66-2"><a href="m3.html#cb66-2" aria-hidden="true" tabindex="-1"></a>plant_effect_var <span class="ot">&lt;-</span> overall_var <span class="sc">-</span> error_var<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb66-3"><a href="m3.html#cb66-3" aria-hidden="true" tabindex="-1"></a>plant_effect_var</span></code></pre></div>
<pre><code>## [1] 105.5747</code></pre>
<p>So, <span class="math inline">\(\hat{b} \sim N(0,\)</span> 105.57 <span class="math inline">\()\)</span> . As you might expect, a lot of the variance in tomato weight that we can’t account for just based on the fertilizer is due to plant-to-plant variation</p>
</div>
</div>
<div id="task-2-life-is-sweet-as-honey" class="section level3" number="16.4.5">
<h3><span class="header-section-number">16.4.5</span> Task 2: Life is sweet as honey</h3>
<p>Your grandmother was a bit eccentric when it came to farm management. She swore that her bees produced more honey if she played them music in the morning. In fact, she even mentioned that she thought they particularly liked K-pop.</p>
<p>She left you some data that she thinks proves this. While the sample size isn’t that large, you decide to take a look anyways. The data is called <code>honey</code> and records the honey produced each month for each of her 6 hives (in grams). Each hive listened to each of the song options (Butter by BTS, Adagio in B minor by Mozart and No music) for a month, three times. The order was randomized for each hive. It took 9 months to collect this data and the information your grandmother left you says honey production should have been fairly constant over this period and that all the hives experienced the same weather conditions, food access, etc.</p>
<p>(Note: this is definitely not accurate to how beekeeping or weather actually works…but ignore this for our purposes.)</p>
<p><img src="images/m3/hive.png" width="10%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="m3.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(honey)</span></code></pre></div>
<pre><code>## Rows: 54
## Columns: 3
## $ hive    &lt;fct&gt; 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 1, 1, 1,…
## $ song    &lt;fct&gt; No music, No music, No music, No music, No music, No music, No…
## $ honey_g &lt;dbl&gt; 196.56, 199.58, 200.71, 195.80, 199.58, 200.71, 226.80, 227.55…</code></pre>
<div id="wrangle-and-plot-the-data" class="section level4" number="16.4.5.1">
<h4><span class="header-section-number">16.4.5.1</span> Wrangle and plot the data</h4>
<ol style="list-style-type: decimal">
<li>Wrangle the honey data so that the <code>song</code> variable is a factor in this order: No music, Adagio in B minor by Mozart and Butter by BTS.</li>
<li>Make <code>hive</code> a factor variable also.</li>
<li>Save this over the original honey dataset.</li>
<li>Then, using your new version of the <code>honey</code> dataset, create a new dataset called <code>honey_agg_int</code>, where you group by <code>hive</code> and <code>song</code> and summarize to find the average amount of honey produced by each hive while listening to a given song. Call your averaged variable <code>honey_avg</code>.</li>
</ol>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="m3.html#cb70-1" aria-hidden="true" tabindex="-1"></a>honey <span class="ot">&lt;-</span> honey <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="m3.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">song =</span> <span class="fu">fct_relevel</span>(song, <span class="st">&quot;No music&quot;</span>, <span class="at">after =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="m3.html#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hive =</span> <span class="fu">as_factor</span>(hive)) </span>
<span id="cb70-4"><a href="m3.html#cb70-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-5"><a href="m3.html#cb70-5" aria-hidden="true" tabindex="-1"></a>honey_agg_int <span class="ot">&lt;-</span> honey <span class="sc">%&gt;%</span>   </span>
<span id="cb70-6"><a href="m3.html#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hive, song) <span class="sc">%&gt;%</span> </span>
<span id="cb70-7"><a href="m3.html#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">honey_avg =</span> <span class="fu">mean</span>(honey_g), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) </span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Plot the <code>honey_agg_int</code> data with <code>song</code> on the x axis and <code>honey_avg</code> on the y axis.</li>
<li>In your aesthetic, you should also colour by hive and group by hive. (See the hint if you get stuck).</li>
<li>Use the point and line geometries.</li>
<li>Use <code>theme_minimal()</code> if you like.</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="m3.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This assumes you&#39;ve run the correct code for the wrangling above</span></span>
<span id="cb71-2"><a href="m3.html#cb71-2" aria-hidden="true" tabindex="-1"></a>honey_agg_int <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="m3.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> song, <span class="at">y =</span> honey_avg, <span class="at">colour =</span> hive, <span class="at">group =</span> hive)) <span class="sc">+</span></span>
<span id="cb71-4"><a href="m3.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb71-5"><a href="m3.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb71-6"><a href="m3.html#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="STA303-Course-guide_files/figure-html/bee_plot-solution-1.png" width="672" /></p>
<p>We’ve actually made an interaction plot for our data. There is a function in the core <code>stats</code> package that also does this for us.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="m3.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(honey<span class="sc">$</span>song, honey<span class="sc">$</span>hive, honey<span class="sc">$</span>honey_g)</span></code></pre></div>
<p><img src="STA303-Course-guide_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p><strong>Question: What has us worried about the independence assumption if we were just going to do regression as usual?</strong></p>
<p>A. We don’t expect honey production while listening to the same song to be independent.<br />
B. We don’t expect production for a given hive to be independent from month to month.<br />
C. We don’t expect these observations to be independent because they all experienced the same weather conditions and food availability.<br />
D. No concerns about the independence assumption.</p>
<p>Answer: B. We expect that some hives will be more productive than others, naturally; a ‘hive’ effect. We want to estimate if there is in fact an effect of song, so that isn’t an independence violation. We’re glad the other conditions that could affect honey production were similar across the whole period for all hives as this means any difference we see is likely due to song effect (once we account for hive effect), not weather fluctuations.</p>
<p>This data is an example of <strong>crossed effects</strong>, because every hive experiences every level of the ‘treatment,’ i.e. each hive listens to each song.</p>
<p><strong>Question: What would a completely nested version of this study look like?</strong></p>
<p>A. This is both nested and crossed already.<br />
B. Assign hives 1, 2 and to listen to randomly swap between no music for and then Mozart for 9 months. Hives 4, 5 and 6 would be similar but BTS instead of Mozart.<br />
C. Repeated measures (x9) of honey production on each hive, listening to the same song, for 9 months.<br />
D. Not possible to design a nested version.</p>
<p>Answer: C. You can’t be nested and crossed for the same grouping variable. A fully nested version of this would be much like our tomato study, with two hives assigned to each song.</p>
</div>
<div id="model-formula-1" class="section level4" number="16.4.5.2">
<h4><span class="header-section-number">16.4.5.2</span> Model formula</h4>
<p>This looks like:
<span class="math display">\[ y_{ijk} = \mu + \alpha_i + b_{j} + + (\alpha b)_{ij} + \epsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(y_{ijk}\)</span> is the amount of honey produced (in grams) in the <span class="math inline">\(k^{th}\)</span> month by the <span class="math inline">\(j^{th}\)</span> hive while listening to song <span class="math inline">\(i\)</span>. Here, <span class="math inline">\(\mu\)</span> is the grand mean of honey production, <span class="math inline">\(\alpha_i\)</span> are the <span class="math inline">\(I\)</span> fixed effects for <code>song</code> and <span class="math inline">\(b_j\)</span> are the random effects for hive <span class="math inline">\(j\)</span>. <span class="math inline">\((\alpha b)_{ij}\)</span> are the <span class="math inline">\(IJ\)</span> interaction terms for the interaction between the the hive and the song. What does this represent here? Well, maybe some hives respond to a certain song quite differently to other hives. <span class="math inline">\((\alpha b)_{ij}\)</span> is a random effect because any term involving a random effect must also be a random effect. <span class="math inline">\((\alpha b)_{ij} ~ \sim N(0, \sigma^2_{\alpha b})\)</span>, <span class="math inline">\(b_j \sim N(0, \sigma_b^2)\)</span> and <span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>. All the random effects are mutually independent random variables.</p>
</div>
<div id="fit-the-models" class="section level4" number="16.4.5.3">
<h4><span class="header-section-number">16.4.5.3</span> Fit the models</h4>
<ol style="list-style-type: decimal">
<li>Fit an interaction model (main effects and interactions) to predict honey production based on <code>song</code> and <code>hive</code>. Call it <code>bee_int_mod</code>.<br />
</li>
<li>Fit a main effects (no interactions) model to predict honey production based on <code>song</code> and <code>hive</code> (no interaction). Call it <code>bee_main</code>.<br />
</li>
<li>Compare these two models with ANOVA.</li>
</ol>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="m3.html#cb73-1" aria-hidden="true" tabindex="-1"></a>bee_int_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(honey_g <span class="sc">~</span> song<span class="sc">*</span>hive, <span class="at">data =</span> honey)</span>
<span id="cb73-2"><a href="m3.html#cb73-2" aria-hidden="true" tabindex="-1"></a>bee_main <span class="ot">&lt;-</span> <span class="fu">lm</span>(honey_g <span class="sc">~</span> song <span class="sc">+</span> hive, <span class="at">data =</span> honey)</span>
<span id="cb73-3"><a href="m3.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bee_int_mod, bee_main)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: honey_g ~ song * hive
## Model 2: honey_g ~ song + hive
##   Res.Df    RSS  Df Sum of Sq      F    Pr(&gt;F)    
## 1     36  475.5                                   
## 2     46 6570.0 -10   -6094.5 46.141 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><strong>Question: What do you think we can claim from the analysis above?</strong></p>
<p>A. It seems unlikely that the variance for the interaction terms is 0.<br />
B. There is no evidence against the hypothesis that the main effects model fits the data as well as the interaction model.<br />
C. These models are not identifiable.</p>
<p>Answer: A. Because the the model with the interaction explains the data significantly better than the main effects only model, we can say it seems like the variability explained by the interaction is going to be important, i.e. we need interaction terms because they aren’t all the same value (which is how we’d have zero variance). These models are identifiable. (Run a summary on them, you’ll get no errors.)</p>
</div>
<div id="model-with-our-aggregated-data" class="section level4" number="16.4.5.4">
<h4><span class="header-section-number">16.4.5.4</span> Model with our aggregated data</h4>
<ol style="list-style-type: decimal">
<li>Run a new model using the <code>honey_agg_int</code> data, where <code>honey_avg</code> is the response and song and hive are fixed effects, no interactions. Save the model as <code>bee_agg_mod</code>.</li>
<li>Run an ANOVA on <code>bee_agg_mod</code>.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="m3.html#cb75-1" aria-hidden="true" tabindex="-1"></a>bee_agg_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(honey_avg <span class="sc">~</span> song <span class="sc">+</span> hive, <span class="at">data =</span> honey_agg_int)</span>
<span id="cb75-2"><a href="m3.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(bee_agg_mod)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: honey_avg
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## song       2 8360.1  4180.1  20.576 0.0002855 ***
## hive       5 5914.7  1182.9   5.823 0.0089508 ** 
## Residuals 10 2031.5   203.1                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The very low p-values you’ll see above suggest that we can also reject <span class="math inline">\(H_0: \sigma^2_b = 0\)</span> and <span class="math inline">\(H_0: \alpha_{BTS} = \alpha_{Mozart} = \alpha_{no\ song} = 0\)</span> because it seems plausible that there is hive-to-hive variation, and that there are differences in honey production between the songs.</p>
</div>
<div id="describing-our-residuals" class="section level4" number="16.4.5.5">
<h4><span class="header-section-number">16.4.5.5</span> Describing our residuals</h4>
<p>Recall the formula for the residual sum of squares (RSS):</p>
<p><span class="math display">\[RSS = \Sigma^{n}_{i=1} \color{green}{e_i}^2 = \Sigma^{n}_{i=1} (\color{orange}{y_i} - \color{blue}{\hat{y_i}})\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\color{green}{e_i}\)</span> is the residual for observation <span class="math inline">\(i\)</span><br />
</li>
<li><span class="math inline">\(\color{orange}{y_i}\)</span> is the observed value of the response variable for the <span class="math inline">\(i^{th}\)</span> observation<br />
</li>
<li><span class="math inline">\(\color{blue}{\hat{y_i}}\)</span> is the <strong>predicted</strong> value (from the model) for the <span class="math inline">\(i^{th}\)</span> observation</li>
</ul>
<div id="calculate-the-residual-sum-of-squares-for-the-bee_int_mod-model.-save-it-as-rss_int." class="section level5" number="16.4.5.5.1">
<h5><span class="header-section-number">16.4.5.5.1</span> Calculate the residual sum of squares for the <code>bee_int_mod</code> model. Save it as <code>rss_int</code>.</h5>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="m3.html#cb77-1" aria-hidden="true" tabindex="-1"></a>rss_int <span class="ot">&lt;-</span> <span class="fu">sum</span>((honey<span class="sc">$</span>honey_g <span class="sc">-</span> <span class="fu">predict</span>(bee_int_mod))<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p><span class="math display">\[RSE = \sqrt{\frac{RSS}{\color{red}n-\color{blue}p-1}}\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(RSS\)</span> is the residual sum of squares</li>
<li><span class="math inline">\(\color{red}n\)</span> is the number of observations in your dataset (that are being used for the model, must be complete cases for the variables being used)</li>
<li><span class="math inline">\(\color{blue}p\)</span> is the number of coefficients being estimated in our model (not including the intercept)</li>
</ul>
</div>
<div id="calculate-the-rse-for-the-bee_int_mod-model." class="section level5" number="16.4.5.5.2">
<h5><span class="header-section-number">16.4.5.5.2</span> Calculate the RSE for the <code>bee_int_mod</code> model.</h5>
<ul>
<li>Start by getting the sample size from the data (i.e., don’t ‘hard code’ it). Save it as <code>n_int</code>.
<ul>
<li>Hint: <code>nrow()</code> is a useful function for finding the number of rows of a dataset.<br />
</li>
</ul></li>
<li>Calculate the degrees of freedom for your model. This is ‘easy’ (for a given value of easy…) to do by hand for balanced designs, but not something you’ll do for more complicated models in practice.
<ul>
<li>Hint: <span class="math inline">\(n-p-1\)</span></li>
<li>Save the value as <code>df_int</code></li>
</ul></li>
<li>Finally, use these objects and <code>rss</code> calculated above to calculate the RSE. Save the object as <code>rse_int</code>.
<ul>
<li>You can check if you are right by comparing to the RSE from the fitted model: <code>Residual standard error: 3.634 on 36 degrees of freedom</code><br />
</li>
<li>You can also check it directly with <code>summary(bee_int_mod)$sigma</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="m3.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb78-2"><a href="m3.html#cb78-2" aria-hidden="true" tabindex="-1"></a>n_int <span class="ot">&lt;-</span> <span class="fu">nrow</span>(honey)</span>
<span id="cb78-3"><a href="m3.html#cb78-3" aria-hidden="true" tabindex="-1"></a>n_int</span></code></pre></div>
<pre><code>## [1] 54</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="m3.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Degrees of freedom for the model</span></span>
<span id="cb80-2"><a href="m3.html#cb80-2" aria-hidden="true" tabindex="-1"></a>df_int <span class="ot">&lt;-</span> n_int <span class="sc">-</span> <span class="fu">nrow</span>(<span class="fu">summary</span>(bee_int_mod)<span class="sc">$</span>coefficients)</span>
<span id="cb80-3"><a href="m3.html#cb80-3" aria-hidden="true" tabindex="-1"></a>df_int</span></code></pre></div>
<pre><code>## [1] 36</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="m3.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate RSE</span></span>
<span id="cb82-2"><a href="m3.html#cb82-2" aria-hidden="true" tabindex="-1"></a>rse_int <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rss_int<span class="sc">/</span>(df_int))</span>
<span id="cb82-3"><a href="m3.html#cb82-3" aria-hidden="true" tabindex="-1"></a>rse_int</span></code></pre></div>
<pre><code>## [1] 3.63432</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="m3.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check RSE from the model</span></span>
<span id="cb84-2"><a href="m3.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bee_int_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = honey_g ~ song * hive, data = honey)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4400 -1.9533  0.1883  1.7300  9.0700 
## 
## Coefficients:
##                                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                           198.9500     2.0983  94.816  &lt; 2e-16 ***
## songAdagio in B minor by Mozart        38.8067     2.9674  13.078 3.05e-15 ***
## songButter by BTS                      55.0633     2.9674  18.556  &lt; 2e-16 ***
## hive2                                  -0.2533     2.9674  -0.085  0.93244    
## hive3                                  26.0833     2.9674   8.790 1.73e-10 ***
## hive4                                  -5.2933     2.9674  -1.784  0.08288 .  
## hive5                                  -4.7867     2.9674  -1.613  0.11546    
## hive6                                 -22.0500     2.9674  -7.431 9.01e-09 ***
## songAdagio in B minor by Mozart:hive2 -12.3433     4.1966  -2.941  0.00568 ** 
## songButter by BTS:hive2               -20.0333     4.1966  -4.774 2.99e-05 ***
## songAdagio in B minor by Mozart:hive3  -6.6800     4.1966  -1.592  0.12018    
## songButter by BTS:hive3               -12.4767     4.1966  -2.973  0.00523 ** 
## songAdagio in B minor by Mozart:hive4   4.6633     4.1966   1.111  0.27384    
## songButter by BTS:hive4                -3.9067     4.1966  -0.931  0.35809    
## songAdagio in B minor by Mozart:hive5  12.9800     4.1966   3.093  0.00382 ** 
## songButter by BTS:hive5                21.9200     4.1966   5.223 7.58e-06 ***
## songAdagio in B minor by Mozart:hive6 -50.7767     4.1966 -12.100 3.02e-14 ***
## songButter by BTS:hive6                -0.2500     4.1966  -0.060  0.95283    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.634 on 36 degrees of freedom
## Multiple R-squared:  0.9904, Adjusted R-squared:  0.9858 
## F-statistic: 217.9 on 17 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="m3.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can pull the value directly from the model summary with $sigma</span></span>
<span id="cb86-2"><a href="m3.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bee_int_mod)<span class="sc">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 3.63432</code></pre>
</div>
</div>
<div id="calculating-our-random-effect-variances" class="section level4" number="16.4.5.6">
<h4><span class="header-section-number">16.4.5.6</span> Calculating our random effect variances</h4>
<div id="overview" class="section level5" number="16.4.5.6.1">
<h5><span class="header-section-number">16.4.5.6.1</span> Overview</h5>
<p>In this section I’m just going claim a couple equations for how we can partition (separate into components) the unexplained variation in the models we have fit.</p>
<p>We will have a variance component for every one of our random effects (and interactions between a fixed and random effect are also random effects themselves!) as well as the overall residual variance.</p>
<p>We can use this to claim what proportion of variance is explained by our different random effects and what proportion remains unexplained by our variables.</p>
<p>I practice, we’ll let R handle this for us, especially as things will get a little messier when we leave the safety of balanced designs. See the Wood reading referenced in the credits if you want to cover this further now. Optional, <em>not</em> assessed.</p>
<p>Basically, I want you to take away from this section that <strong>we can estimate how much our different sources of variation are each contributing to our overall variation.</strong></p>
</div>
<div id="unexplained-variance-after-fitting-the-interaction-model" class="section level5" number="16.4.5.6.2">
<h5><span class="header-section-number">16.4.5.6.2</span> Unexplained variance after fitting the interaction model</h5>
<p>As we saw above, our unexplained variability, after fitting the interaction model (the most complicated linear model possible for this data), <code>bee_int_mod</code>, gives us our <span class="math inline">\(\sigma^2\)</span>, i.e., the variability of the error term is <span class="math inline">\(\sigma^2 = 3.63^2\)</span>.</p>
<p>Save the squared residual standard error from the <code>bee_int_mod</code> model as <code>var_int</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="m3.html#cb88-1" aria-hidden="true" tabindex="-1"></a>var_int <span class="ot">&lt;-</span> <span class="fu">summary</span>(bee_int_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb88-2"><a href="m3.html#cb88-2" aria-hidden="true" tabindex="-1"></a>var_int</span></code></pre></div>
<pre><code>## [1] 13.20828</code></pre>
</div>
<div id="rse-for-main-effects-model-on-aggregated-data" class="section level5" number="16.4.5.6.3">
<h5><span class="header-section-number">16.4.5.6.3</span> RSE for main effects model on aggregated data</h5>
<p>Next, we want to consider the what portion of the variability is explained by the interaction of hive and song. Our <code>bee_agg_mod</code> residual variance will come from two sources: the variance that CAN be explained by the interaction of hive and song AND the variability we cannot explain (even with out most complicated model), our random error.</p>
<p><span class="math display">\[\text{RSE}_{bee\_agg}^2 = \sigma_{\alpha b}^2 + \frac{\sigma^2}{K} \]</span></p>
<p>So, <span class="math inline">\(\text{RSE}_{bee\_agg}\)</span> is the <code>sigma</code> value calculated from our main effects only model on the aggregated data, and <span class="math inline">\(K\)</span> is the number of observations at each level of our interaction, i.e., the number of levels we have averaged over in aggregating this data. We want this value as we can use it to take the average of the squared errors from our interaction model (remember that <span class="math inline">\(sigma^2\)</span> is the RSE squared.)</p>
<p>We can get <span class="math inline">\(K\)</span> from the context, by understanding that each hive was exposed to each song for 3 months and honey production was measured monthly. OR we can remember that this design is balanced and divide the total sample size (<span class="math inline">\(n = 54\)</span>) by the number of combinations (levels of interaction) which will be 6 hives times 3 songs, which is then <span class="math inline">\(\frac{54}{6\cdot 3} = 3\)</span>.</p>
<p>Doing some rearranging, we now can calculate <span class="math inline">\(\sigma_{\alpha b}^2\)</span> from other values we have available to us.</p>
<p><span class="math display">\[\sigma_{\alpha b}^2 = \text{RSE}_{bee\_agg}^2 - \frac{\sigma^2}{K} = \]</span> 198.75</p>
<p>Calculate <span class="math inline">\(\sigma_{\alpha b}^2\)</span> and save it as <code>var_ab</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="m3.html#cb90-1" aria-hidden="true" tabindex="-1"></a>var_ab <span class="ot">&lt;-</span> <span class="fu">summary</span>(bee_agg_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> var_int <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb90-2"><a href="m3.html#cb90-2" aria-hidden="true" tabindex="-1"></a>var_ab</span></code></pre></div>
<pre><code>## [1] 198.7458</code></pre>
</div>
<div id="hive-to-hive-variance" class="section level5" number="16.4.5.6.4">
<h5><span class="header-section-number">16.4.5.6.4</span> Hive-to-hive variance</h5>
<p>Finally, to get <span class="math inline">\(\sigma^2_{b}\)</span> we do one final aggregation and model.</p>
<p>Start by creating a new dataset called <code>honey_agg_hive</code>.</p>
<ul>
<li>Start with the <code>honey</code> data<br />
</li>
<li>Group by <code>hive</code><br />
</li>
<li>Use summarize to get the <code>honey_avg_hive</code>
<ul>
<li>You can use <code>.groups = "drop"</code> as an argument in your <code>summarize</code> call if you are getting a message about dropping groups.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="m3.html#cb92-1" aria-hidden="true" tabindex="-1"></a>honey_agg_hive <span class="ot">&lt;-</span> honey <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="m3.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hive) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="m3.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">honey_avg_hive =</span> <span class="fu">mean</span>(honey_g))</span>
<span id="cb92-4"><a href="m3.html#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="m3.html#cb92-5" aria-hidden="true" tabindex="-1"></a>honey_agg_hive</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   hive  honey_avg_hive
##   &lt;fct&gt;          &lt;dbl&gt;
## 1 1               230.
## 2 2               219.
## 3 3               250.
## 4 4               225.
## 5 5               237.
## 6 6               191.</code></pre>
<p>Once you have your <code>honey_agg_hive</code> dataset, use it to fit an <strong>intercept-only</strong> model, saved as <code>bee_hive_mod</code> that effectively just calculate one coefficient, the grand mean of honey production in our data. The <strong>RSE</strong> for this model is really the same as the standard deviation of average honey production, hive-to-hive.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="m3.html#cb94-1" aria-hidden="true" tabindex="-1"></a>bee_hive_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(honey_avg_hive <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> honey_agg_hive)</span>
<span id="cb94-2"><a href="m3.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bee_hive_mod)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = honey_avg_hive ~ 1, data = honey_agg_hive)
## 
## Residuals:
##        1        2        3        4        5        6 
##   4.7669  -6.2787  24.4646  -0.2743  11.6135 -34.2920 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  225.473      8.107   27.81 1.12e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.86 on 5 degrees of freedom</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="m3.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the RSE here is just the SD of the average honey production hive-to-hive</span></span>
<span id="cb96-2"><a href="m3.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">var</span>(honey_agg_hive<span class="sc">$</span>honey_avg_hive))</span></code></pre></div>
<pre><code>## [1] 19.85727</code></pre>
<p>So now we can take our hive-to-hive variability subtract the variability explained by the song and hive main effects, and find the variability in honey output hive-to-hive not explained by song or song/hive interactions. We are dividing by I (the number of songs) because we are averaging across them.</p>
<p><span class="math display">\[ \sigma_b^2 = \text{RSE}_{bee\_hive}^2 - \frac{\text{RSE}_{bee\_agg}^2}{I}\]</span></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="m3.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hive to hive variation, not explained by song or song/hive interaction</span></span>
<span id="cb98-2"><a href="m3.html#cb98-2" aria-hidden="true" tabindex="-1"></a>var_hive <span class="ot">&lt;-</span> <span class="fu">summary</span>(bee_hive_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (<span class="fu">summary</span>(bee_agg_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb98-3"><a href="m3.html#cb98-3" aria-hidden="true" tabindex="-1"></a>var_hive</span></code></pre></div>
<pre><code>## [1] 326.595</code></pre>
</div>
<div id="summary-of-all-our-calculated-error-variances" class="section level5" number="16.4.5.6.5">
<h5><span class="header-section-number">16.4.5.6.5</span> Summary of all our calculated error variances</h5>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="m3.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance in honey production explained by the interaction of song and hive</span></span>
<span id="cb100-2"><a href="m3.html#cb100-2" aria-hidden="true" tabindex="-1"></a>var_ab <span class="ot">&lt;-</span> <span class="fu">summary</span>(bee_agg_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> var_int <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb100-3"><a href="m3.html#cb100-3" aria-hidden="true" tabindex="-1"></a>var_ab</span></code></pre></div>
<pre><code>## [1] 198.7458</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="m3.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance in honey production explained by hive to hive variance</span></span>
<span id="cb102-2"><a href="m3.html#cb102-2" aria-hidden="true" tabindex="-1"></a>var_hive <span class="ot">&lt;-</span> <span class="fu">summary</span>(bee_hive_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> (<span class="fu">summary</span>(bee_agg_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb102-3"><a href="m3.html#cb102-3" aria-hidden="true" tabindex="-1"></a>var_hive</span></code></pre></div>
<pre><code>## [1] 326.595</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="m3.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residual variance (unexplained)</span></span>
<span id="cb104-2"><a href="m3.html#cb104-2" aria-hidden="true" tabindex="-1"></a>var_int <span class="ot">&lt;-</span> <span class="fu">summary</span>(bee_int_mod)<span class="sc">$</span>sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb104-3"><a href="m3.html#cb104-3" aria-hidden="true" tabindex="-1"></a>var_int</span></code></pre></div>
<pre><code>## [1] 13.20828</code></pre>
<p>We can all talk about the proportion of variance explained by each of our sources of variation. This is also called intraclass correlation coefficient (ICC) or the variance partition coefficient (VPC). We can calculate it by finding the sum of all these variances, and setting that value as our denominator.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="m3.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Source =</span> <span class="fu">c</span>(<span class="st">&quot;song:hive&quot;</span>, <span class="st">&quot;hive&quot;</span>, <span class="st">&quot;residual&quot;</span>),</span>
<span id="cb106-2"><a href="m3.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Proportion of variance explained</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb106-3"><a href="m3.html#cb106-3" aria-hidden="true" tabindex="-1"></a>    var_ab <span class="sc">/</span> (var_ab <span class="sc">+</span> var_hive <span class="sc">+</span> var_int),</span>
<span id="cb106-4"><a href="m3.html#cb106-4" aria-hidden="true" tabindex="-1"></a>    var_hive <span class="sc">/</span> (var_ab <span class="sc">+</span> var_hive <span class="sc">+</span> var_int),</span>
<span id="cb106-5"><a href="m3.html#cb106-5" aria-hidden="true" tabindex="-1"></a>    var_int <span class="sc">/</span> (var_ab <span class="sc">+</span> var_hive <span class="sc">+</span> var_int))) <span class="sc">%&gt;%</span> </span>
<span id="cb106-6"><a href="m3.html#cb106-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Source
</th>
<th style="text-align:right;">
Proportion of variance explained
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
song:hive
</td>
<td style="text-align:right;">
0.3690394
</td>
</tr>
<tr>
<td style="text-align:left;">
hive
</td>
<td style="text-align:right;">
0.6064349
</td>
</tr>
<tr>
<td style="text-align:left;">
residual
</td>
<td style="text-align:right;">
0.0245257
</td>
</tr>
</tbody>
</table>
<p><strong>Question: Which of our random effects explains the greatest variance in the honey production, after controlling for our fixed effects?</strong></p>
<p>A. Variations in the interaction between the hives and songs.<br />
B. Random noise.<br />
C. Hive-to-hive variability.<br />
D. Impossible to say.</p>
<p>Answer: C. Of the three variances for our random effects, the variance for the hive effect is the largest, and so explains the greatest proportion of the variability in honey production not explained by the song differences."</p>
</div>
</div>
<div id="summary-1" class="section level4" number="16.4.5.7">
<h4><span class="header-section-number">16.4.5.7</span> Summary</h4>
<p>Note the below notation is is based on using least squares and treating all variables as fixed effects. This isn’t the way you would explain a linear model in practice, but I hope helps you see how we are thinking about partitioning our variance. It also helps remind us that regression is just fancy averaging.</p>
<p><img src="images/m3/fancyaveraging.png" width="592" /></p>
<p><a href="https://twitter.com/ajeanstevenson/status/1488601482505060352">Link to tweet</a></p>
<p>Note: The <span class="math inline">\(\cdot\)</span> you’ll see in some of the following subscripts indicate where we are aggregating and averaging across that level of the data.</p>
<div id="full-interaction-model-includes-main-effects-bee_int_mod" class="section level5" number="16.4.5.7.1">
<h5><span class="header-section-number">16.4.5.7.1</span> Full interaction model (includes main effects) (<code>bee_int_mod</code>)</h5>
<table>
<colgroup>
<col width="16%" />
<col width="47%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th>In R</th>
<th>Notation</th>
<th>RSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>lm(honey_g ~ song*hive, data = honey)</code></td>
<td><p><span class="math inline">\(y_{ijk} = \mu + \alpha_i + b_j + (\alpha b)_{ij} + \epsilon_{ijk}\)</span></p>
<p><strong>Traditional linear regression</strong></p>
<p><span class="math inline">\(y_{ijk} = \beta_0 + \beta_1 \text{song}_i + \beta_2\text{hive}_j + \beta_3\text{song}_i\text{hive}_j + \epsilon_{ijk}\)</span></p>
<p><br />
These are equivalent, just with different contrasts (how we set up our model matrix).</p></td>
<td><span class="math inline">\(RSE^2\)</span> is <span class="math inline">\(\sigma^2\)</span> is the unexplained variation after fitting the most complicated model.</td>
</tr>
</tbody>
</table>
</div>
<div id="main-effects-only-model-on-hivesong-aggregated-data-bee_agg_mod" class="section level5" number="16.4.5.7.2">
<h5><span class="header-section-number">16.4.5.7.2</span> Main effects only model, on hive/song aggregated data (<code>bee_agg_mod</code>)</h5>
<table>
<colgroup>
<col width="14%" />
<col width="27%" />
<col width="57%" />
</colgroup>
<thead>
<tr class="header">
<th>In R</th>
<th>Notation</th>
<th>RSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>lm(honey_g ~ song + hive, data = honey_agg)</code></td>
<td><p><span class="math inline">\(y_{ij\cdot} = \mu + \alpha_i + b_j + \epsilon_{ij}\)</span></p>
<p>where</p>
<p><span class="math inline">\(\epsilon_{ij} = (\alpha b)_{ij}+\frac{1}{K}\Sigma_{k=1}^n\)</span></p>
<p><strong>Traditional linear regression</strong></p>
<p><span class="math inline">\(y_{ij\cdot} = \beta_0 + \beta_1 \text{song}_i + \beta_2\text{hive}_j + \epsilon_{ij}\)</span></p></td>
<td>The <span class="math inline">\(RSE^2\)</span> here is the unexplained variation in the average honey production after accounting for the main effects of song and hive. We will use it to help find <span class="math inline">\(\sigma_{\alpha b}\)</span>.</td>
</tr>
</tbody>
</table>
</div>
<div id="intercept-only-model-for-hives-averages-bee_hive_mod" class="section level5" number="16.4.5.7.3">
<h5><span class="header-section-number">16.4.5.7.3</span> Intercept only model for hives averages (<code>bee_hive_mod</code>)</h5>
<table>
<colgroup>
<col width="14%" />
<col width="25%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>In R</th>
<th>Notation</th>
<th>RSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><code>lm(honey_g ~ 1, data = honey_agg_hive)</code></p>
<p>(note aggregated dataset)</p></td>
<td><p><span class="math inline">\(y_{\cdot j \cdot} = \mu + \frac{1}{I}\Sigma^I_{i = 1}\alpha_i + \epsilon\)</span></p>
<p>where:</p>
<p><span class="math inline">\(\epsilon_j = b_j + \frac{1}{I}\Sigma\epsilon_j\)</span></p>
<p><strong>Traditional linear regression</strong></p>
<p><span class="math inline">\(y_{\cdot j\cdot} = \beta_0 + \epsilon_{j}\)</span></p></td>
<td>The <span class="math inline">\(RSE^2\)</span> here is hive-to-hive variation in average honey output (without taking into account the interaction between hive and song). We will use it to help find <span class="math inline">\(\sigma_{b}\)</span>.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="where-to-next" class="section level3" number="16.4.6">
<h3><span class="header-section-number">16.4.6</span> Where to next?</h3>
<p>We’ve done pretty much everything we can while remaining in the ordinary least squares context, and even in the simplest examples, all the aggregating and model fitting we’re doing will get a little tedious. Now we will turn to fitting <strong>linear mixed models</strong> more in more sophisticated ways with a specialist package.</p>
<p>The models we’ll be fitting will rely on maximum likelihood methods.</p>
</div>
<div id="credits-1" class="section level3" number="16.4.7">
<h3><span class="header-section-number">16.4.7</span> Credits</h3>
<ul>
<li>The commentary for this activity draws heavily on section 2.1 of
Wood, S. Generalized Additive Models: An Introduction with R, 2nd Edition. 2017. <a href="https://ebookcentral-proquest-com.myaccess.library.utoronto.ca/lib/utoronto/detail.action?docID=4862399" class="uri">https://ebookcentral-proquest-com.myaccess.library.utoronto.ca/lib/utoronto/detail.action?docID=4862399</a> (requires you to log in with your UTORid).</li>
<li>Overall concept based on the <a href="https://www.stardewvalley.net/">Stardew Valley</a> game.</li>
<li>Stardew Valley images from <a href="https://stardewcommunitywiki.com" class="uri">https://stardewcommunitywiki.com</a>.</li>
</ul>
</div>
</div>
<div id="vocal-pitch-case-study-part-1-lmms" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Vocal pitch case study: Part 1 (LMMs)</h2>
<div id="motivation" class="section level3" number="16.5.1">
<h3><span class="header-section-number">16.5.1</span> Motivation</h3>
<p>You’re interested in a language and especially want to investigate how <strong>voice pitch</strong> (perceived “highness” or “lowness” of a voice) is related to politeness for speakers of that language.</p>
</div>
<div id="design-of-the-experiment" class="section level3" number="16.5.2">
<h3><span class="header-section-number">16.5.2</span> Design of the experiment</h3>
<ul>
<li>You recruit 6 speakers of the language as subjects in your study.</li>
<li>There are 3 males and 3 females.</li>
<li>Each subject is asked to respond to 14 hypothetical situations.
<ul>
<li>7 of these situations are <em>formal</em> situations that usually require politeness (e.g., giving an excuse for being late to your scary boss), and</li>
<li>7 were more <em>informal</em> situations (e.g., explaining to a friend why you are late).</li>
</ul></li>
<li>For each hypothetical situation you measure the subjects voice pitch as they respond. You also take note of each of your subjects’ sex, since you know that’s another important influence on voice pitch.</li>
</ul>
<p>Note: Much of the content here is adapted from Winter, B. (2013). <strong>Linear models and linear mixed effects models in R with linguistic applications</strong>. arXiv:1308.5499. The language considered was Korean.</p>
<p><img src="images/m3/boss.jpeg" width="50%" /><img src="images/m3/friend.jpeg" width="50%" /></p>
<p>Photos from unsplash.com</p>
</div>
<div id="read-in-the-data-and-explore-it" class="section level3" number="16.5.3">
<h3><span class="header-section-number">16.5.3</span> Read in the data and explore it</h3>
<p>For convenience, I have created a new variable called <code>condition</code>, it is just a modification of the <code>attitude</code> variable, that takes the level <code>formal</code> if the particular measurement was under formal conditions and <code>informal</code> if the measurement was under informal conditions. This variable contains the same information as the <code>attitude</code> variable, just coded how I want it to be, so I remove the <code>attitude</code> variable at the end.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="m3.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data wrangling</span></span>
<span id="cb107-2"><a href="m3.html#cb107-2" aria-hidden="true" tabindex="-1"></a>polite_data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&#39;data/m3/politeness_data.csv&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="m3.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">as_factor</span>(<span class="fu">if_else</span>(attitude <span class="sc">==</span> <span class="st">&quot;pol&quot;</span>, <span class="st">&quot;formal&quot;</span>, <span class="st">&quot;informal&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="m3.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as_factor</span>(gender)) </span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="m3.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(polite_data, <span class="at">width=</span><span class="dv">85</span>)</span></code></pre></div>
<pre><code>## Rows: 84
## Columns: 7
## $ subject   &lt;chr&gt; &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;, &quot;F1&quot;,…
## $ gender    &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, …
## $ scenario  &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 1, 1, 2, 2, 3, 3, 4, 4,…
## $ attitude  &lt;chr&gt; &quot;pol&quot;, &quot;inf&quot;, &quot;pol&quot;, &quot;inf&quot;, &quot;pol&quot;, &quot;inf&quot;, &quot;pol&quot;, &quot;inf&quot;, &quot;pol&quot;, &quot;i…
## $ frequency &lt;dbl&gt; 213.3, 204.5, 285.1, 259.7, 203.9, 286.9, 250.8, 276.8, 231.9, 25…
## $ condition &lt;fct&gt; formal, informal, formal, informal, formal, informal, formal, inf…
## $ sex       &lt;fct&gt; F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F, F,…</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="m3.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(polite_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   subject gender scenario attitude frequency condition sex  
##   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;
## 1 F1      F             1 pol           213. formal    F    
## 2 F1      F             1 inf           204. informal  F    
## 3 F1      F             2 pol           285. formal    F    
## 4 F1      F             2 inf           260. informal  F    
## 5 F1      F             3 pol           204. formal    F    
## 6 F1      F             3 inf           287. informal  F</code></pre>
<p><strong>Without doing any analysis, how might this data violate our assumptions for a linear model?</strong></p>
</div>
<div id="recall-linear-regression-assumptions" class="section level3" number="16.5.4">
<h3><span class="header-section-number">16.5.4</span> Recall: Linear regression assumptions</h3>
<ol style="list-style-type: decimal">
<li><strong>Errors are independent (observations are independent)</strong></li>
<li>Errors are identically distributed and the expected value of the errors is zero, <span class="math inline">\(E[\epsilon_i]=0\)</span></li>
<li>Constant variance (homoscedasticity), <span class="math inline">\(var[\epsilon_i] = \sigma^2\)</span>.</li>
<li>A straight-line relationship exists between the errors <span class="math inline">\(\epsilon_i\)</span> and responses <span class="math inline">\(y_i\)</span></li>
</ol>
<p>1.-3. are usually expressed as assuming the errors are i.i.d normally distributed with mean of zero and variance <span class="math inline">\(\sigma^2\)</span>,
<span class="math display">\[\epsilon_i \sim N(0, \sigma^2)\]</span></p>
<div id="why-we-cant-assume-independence" class="section level4" number="16.5.4.1">
<h4><span class="header-section-number">16.5.4.1</span> Why we can’t assume independence</h4>
<p>Each subject has 14 measurements of their pitch (measured as the frequency of the vibration of your vocal cords) in different scenarios and different levels of politeness (formal/informal).</p>
<p>With this kind of data, since each subject gave multiple responses (a “repeated measures” design), we can see that this would violate the independence assumption that’s important in linear modelling: <strong>multiple responses from the same subject cannot be regarded as independent from each other</strong>.</p>
<p>In this scenario, every person has a <em>slightly different</em> voice pitch. This personal factor affects all responses from the same subject, thus responses are inter-dependent (correlated) within subjects rather than independent. I.e., if you have a generally low voice, even if you change your pitch when you are being informal versus formal, you probably still have a generally low pitch.</p>
<p>There also differences, on <em>average</em> in pitch by sex, so this is something we will also want to account for in our model, later.</p>
<p><strong>So what do we do?</strong></p>
</div>
<div id="lets-start-with-a-picture" class="section level4" number="16.5.4.2">
<h4><span class="header-section-number">16.5.4.2</span> Let’s start with a picture</h4>
<p>Female subjects have an ID starting with “F” and males subjects have an ID starting with “M.” <strong>What do you see?</strong></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="m3.html#cb112-1" aria-hidden="true" tabindex="-1"></a>polite_data <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="m3.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> condition, </span>
<span id="cb112-3"><a href="m3.html#cb112-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> frequency,</span>
<span id="cb112-4"><a href="m3.html#cb112-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span>subject)) <span class="sc">+</span></span>
<span id="cb112-5"><a href="m3.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb112-6"><a href="m3.html#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-7"><a href="m3.html#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb112-8"><a href="m3.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label=</span><span class="st">&quot;Voice pitch by subjects and formal/informal setting&quot;</span>) <span class="sc">+</span></span>
<span id="cb112-9"><a href="m3.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb112-10"><a href="m3.html#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="co"># remove legend because we have facet names</span></span></code></pre></div>
<p><img src="images/m3/explore.png" width="100%" /></p>
<div id="key-themes-from-our-plot" class="section level5" number="16.5.4.2.1">
<h5><span class="header-section-number">16.5.4.2.1</span> Key themes from our plot</h5>
<ol style="list-style-type: decimal">
<li>Males tend to have lower voices than females.</li>
<li>Within the male and the female groups, there is plenty of individual variation. Some subjects have relatively high pitch for their sex and others have relatively low values, regardless of the formal/informal version of the scenario.</li>
<li>Subjects seem to generally use a higher pitch when speaking informally than they do when speaking formally.</li>
</ol>
<p><strong>Before we can go further with this case study, let’s establish a few things…</strong></p>
</div>
</div>
</div>
</div>
<div id="linear-mixed-models" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> Linear mixed models</h2>
<div id="thoughts-on-plots-for-hierarchicalcorrelated-data-generally" class="section level3" number="16.6.1">
<h3><span class="header-section-number">16.6.1</span> Thoughts on plots for hierarchical/correlated data generally</h3>
<ul>
<li>Make use of faceted plots! You may have also seen these called lattice plots or trellis plots. These plots show you relationships in your data, conditioned on one or more of your other variables. Facet based on your grouping units.</li>
<li>When working with ggplot you can facet by adding the <code>facet_wrap</code> command. You can control which variables you condition on and how many rows and columns the facets are organised into. (There are lots of other great features we won’t go in to in depth here.)</li>
</ul>
<p>E.g. <code>plot +  facet_wrap(~one_var)</code> or
<code>plot +  facet_wrap(~one_var + two var, nrow = 3)</code></p>
<p>Assume <code>plot</code> is a ggplot object.</p>
<p><img src="images/m3/trellis.jpeg" width="100%" style="display: block; margin: auto;" /></p>
<p>These names come from the appearance of these plots being similar to the lattice of a garden trellis. They also show you different <em>faces</em> (facets) of your data.]</p>
</div>
<div id="assumptions-3" class="section level3" number="16.6.2">
<h3><span class="header-section-number">16.6.2</span> Assumptions</h3>
<p>Linear mixed models assume that:</p>
<ol style="list-style-type: decimal">
<li>There is a continuous response variable.</li>
<li>We have modelled the dependency structure correctly (i.e. made correct choices about our random variables).</li>
<li>Our units/subjects are independent, even through observations within each subject are taken not to to be.</li>
<li>Both the random effects and within-unit residual errors follow normal distributions.</li>
<li>The random effects errors and within-unit residual errors have constant variance .</li>
</ol>
<p>While it is possible to some extent to check these assumptions through various diagnostics, a natural concern is that if one or more assumptions do not hold, our inferences may be invalid. Fortunately it turns out that linear mixed models are robust to violations of some of their assumptions.</p>
</div>
<div id="our-model-set-up" class="section level3" number="16.6.3">
<h3><span class="header-section-number">16.6.3</span> Our model set up</h3>
<div id="our-sta302-linear-model" class="section level4" number="16.6.3.1">
<h4><span class="header-section-number">16.6.3.1</span> Our STA302 linear model</h4>
<p><span class="math display">\[\boldsymbol{y} = \boldsymbol{X\beta} + \boldsymbol{\epsilon}\]</span>
<span class="math display">\[\boldsymbol{\epsilon} \sim N(0, \Lambda_\theta)\]</span></p>
</div>
<div id="linear-mixed-model" class="section level4" number="16.6.3.2">
<h4><span class="header-section-number">16.6.3.2</span> Linear mixed model</h4>
<p><span class="math display">\[\boldsymbol{y} = \boldsymbol{X\beta} + \boldsymbol{Zb} + \epsilon\]</span>
<span class="math display">\[\boldsymbol{b} \sim N(0, \psi_\theta),\ \  \boldsymbol{\epsilon} \sim N(0, \Lambda_\theta)\]</span></p>
<ul>
<li><span class="math inline">\(\boldsymbol{y}\)</span> is vector of outcomes for subject <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(\boldsymbol{X}\)</span> and <span class="math inline">\(\boldsymbol{Z}\)</span> are model matrices for the <strong>fixed</strong> and <strong>random</strong> effects, respectively,</li>
<li>the vector <span class="math inline">\(\boldsymbol{\beta}\)</span> describes the effect of covariates on the mean/expectation of the outcome, <span class="math inline">\(b\)</span> is the random effects for the units (assumed to be normally distributed with mean zero),</li>
<li><span class="math inline">\(\epsilon\)</span> is the residual errors, normally distributed with a given variance and the errors within units are mutually independent. In this course we won’t deal with more complicated situations than a simple error vector that is distributed <span class="math inline">\(N(0, \sigma^2)\)</span>.</li>
</ul>
</div>
<div id="alternative-formulations" class="section level4" number="16.6.3.3">
<h4><span class="header-section-number">16.6.3.3</span> Alternative formulations</h4>
<p>Where you have observations <span class="math inline">\(Y_{ij}\)</span> for repeated measures <span class="math inline">\(j\)</span> on individuals <span class="math inline">\(i\)</span>, you may also see:</p>
<p><span class="math display">\[Y_{ij} = \boldsymbol{X_{ij}\beta} + \epsilon_{ij}\]</span></p>
<p>Where <span class="math inline">\(\epsilon_{ij} = U_i + Z_{ij}\)</span> and <span class="math inline">\(Z_{ij} \sim N(0, \tau^2)\)</span>.</p>
<p>These errors are normally distributed BUT correlated.</p>
<p>OR</p>
<p><span class="math display">\[Y_{ij}|U_i \sim N(\mu_{ij}, \tau^2)\]</span>
<span class="math display">\[\mu_{ij{ = \boldsymbol{X_{ij}\beta}+U_i}}\]</span>
<span class="math display">\[ [U_1,\ldots,U_M]^T \sim MVN(\boldsymbol0, \Sigma)\]</span></p>
<ul>
<li>fixed effects: <span class="math inline">\(\boldsymbol{X_{ij}\beta}\)</span> (what you’re used to)</li>
<li>random effects: <span class="math inline">\(U_i\)</span> for i in 1 to M (new part that makes this a linear mixed model)</li>
</ul>
</div>
</div>
<div id="what-can-correlated-errors-look-like" class="section level3" number="16.6.4">
<h3><span class="header-section-number">16.6.4</span> What can correlated errors look like?</h3>
<div id="random-intercepts" class="section level4" number="16.6.4.1">
<h4><span class="header-section-number">16.6.4.1</span> Random intercepts</h4>
<p>This is one example of dependence. Here, if a subject is above average in one observation, they’re likely to be above average in their other observations.</p>
</div>
<div id="random-slopes" class="section level4" number="16.6.4.2">
<h4><span class="header-section-number">16.6.4.2</span> Random slopes</h4>
<p><img src="images/m3/rand_slope.png" width="100%" style="display: block; margin: auto;" /></p>
<p>In this case, not only would the residuals for subject 1 tend to be positive while the residuals for subject 2 would tend to be negative, the difference would get bigger as x increases. You don’t want that kind of pattern in the residuals!</p>
</div>
<div id="random-slopes-and-intercepts" class="section level4" number="16.6.4.3">
<h4><span class="header-section-number">16.6.4.3</span> Random slopes and intercepts</h4>
<p><img src="images/m3/rand_slope_int.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Subjects appear to have different slopes AND intercepts.</p>
</div>
</div>
<div id="how-do-we-tell-r-which-situation-were-in" class="section level3" number="16.6.5">
<h3><span class="header-section-number">16.6.5</span> How do we tell R which situation we’re in?</h3>
<p>We’ll be using the <code>lmer()</code> function from the <code>lme4</code> package.</p>
<p>Many R packages provide a “vignette” to help you understand how to use the package and the theory behind it.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="m3.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This line only installs lme4 if you haven&#39;t got it installed already</span></span>
<span id="cb113-2"><a href="m3.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span>(<span class="st">&quot;lme4&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>())) <span class="fu">install.packages</span>(<span class="st">&quot;lme4&quot;</span>)</span>
<span id="cb113-3"><a href="m3.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="m3.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;lme4&quot;</span>)</span>
<span id="cb113-5"><a href="m3.html#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">&quot;lmer&quot;</span>)</span></code></pre></div>
<div id="vignette-activity" class="section level4" number="16.6.5.1">
<h4><span class="header-section-number">16.6.5.1</span> Vignette activity</h4>
<p><strong><em>Have you ever looked at a package vignette before?</em></strong></p>
<p>Use the vignette for this package (see the code above) to try to fill out the syntax for the following situations. You may find Table 2 on page 7 of the vignette quite helpful.</p>
<p><img src="images/m3/table.png" width="100%" /></p>
</div>
</div>
<div id="additional-considerations" class="section level3" number="16.6.6">
<h3><span class="header-section-number">16.6.6</span> Additional considerations</h3>
<div id="linear-mixed-models-come-with-lots-of-different-names" class="section level4" number="16.6.6.1">
<h4><span class="header-section-number">16.6.6.1</span> Linear mixed models come with lots of different names</h4>
<p><img src="images/m3/names_for_lmm.png" /></p>
</div>
<div id="fixed-vs.-random-effects" class="section level4" number="16.6.6.2">
<h4><span class="header-section-number">16.6.6.2</span> Fixed vs. random effects</h4>
<p>Fixed effects are the things you care about and want to estimate. You likely chose the factor levels for a specific reason or measured the variable because you are interested in the relationship it has to your response variable.
Random effects can be variables that were opportunistically measured whose variation needs to be accounted for but that you are not necessarily interested in (e.g. spatial block in a large experiment). The levels of the random effect are likely a random subset of all possible levels (although as a rule of thumb, there should usually be at least 5). However, if the experimental design includes nesting or non-independence of any kind, this needs to be accounted for to avoid pseudoreplication.</p>
</div>
<div id="reml" class="section level4" number="16.6.6.3">
<h4><span class="header-section-number">16.6.6.3</span> REML or ML</h4>
<p>The math behind maximum likelihood (ML) and restricted maximum likelihood (REML) is beyond what I will assess you on in this course. The main difference between the two is how they estimate the variance parameters. They will estimate <span class="math inline">\(\beta\)</span>s the same way.</p>
<p>REML is effectively a two-stage approach where estimates of the random effects are conditioned on the fixed effects. REML accounts for the degrees of freedom lost when estimating the fixed effects and provides us with unbiased estimates of our variance components. ML estimates of the variance components tend to be biased downward (smaller than they should be), making us more likely to pick models with simpler random effects structures than we should.</p>
<p>We <strong>prefer ML</strong> if we need to compare two <strong>nested</strong> models based on their <em>fixed effects</em>, as we can’t do likelihood ratio tests with models fit with REML <em>unless</em> the fixed effects are exactly the same. We <strong>prefer REML</strong> when there is a large number of parameters or if our main goal is estimates of our model parameters (random and fixed). Which is <em>usually</em> our goal.</p>
<p>For this course, we’ll usually use REML, unless we are trying to compare nested models with the same random effects. There are often not major differences between the two methods, anyways.</p>
</div>
<div id="confidence-intervals-and-tests" class="section level4" number="16.6.6.4">
<h4><span class="header-section-number">16.6.6.4</span> Confidence intervals and tests</h4>
<p>You can create Wald confidence intervals for fixed effects the way you’re used to from STA302. BUT for our random effects things can get a bit more awkward.</p>
<p>A variance must be in <span class="math inline">\([0, \infty)\)</span>, so what happens if you get an estimate for <span class="math inline">\(\hat{\sigma_b^2}\)</span> that is <span class="math inline">\(0.02 \pm 0.04 = (-0.02, 0.06)\)</span>? We can get into trouble if our variance components are close to the boundary of the parameter space or if a test requires us to fix them at these boundaries.</p>
<p>Despite these difficulties, if our interval estimates of our variance components are pretty safely away from 0, then we can conclude the associated random effect is needed in the model. If it seems that a variance component is effectively 0, than we can conclude we don’t need the associated random effect. We can also get this from likelihood ratio tests, where big or small p-values lead to clear-cut conclusions, but we face more challenges for making inferences when our p-value is close to our decision criteria.</p>
</div>
</div>
</div>
<div id="vocal-pitch-case-study-part-2" class="section level2" number="16.7">
<h2><span class="header-section-number">16.7</span> Vocal pitch case study: Part 2</h2>
<p>Recall:</p>
<p><span class="math display">\[Y_{ij} = \boldsymbol{X_{ij}\beta} + Z_{i}\boldsymbol{b} + \epsilon_{ij}\]</span></p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span> is the vocal pitch for the <span class="math inline">\(i\)</span>th subject on the <span class="math inline">\(j\)</span>th vocal response.</li>
<li><span class="math inline">\(X_{ij}\beta\)</span> has an intercept and an effect for sex and condition (formal/informal)</li>
<li><span class="math inline">\(Z_ib\)</span> represents subject <span class="math inline">\(i\)</span>’s ‘baseline’ pitch</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> is random noise (and potentially other unmeasured confounders)</li>
</ul>
<div id="modelling-individual-means-with-random-intercepts" class="section level3" number="16.7.1">
<h3><span class="header-section-number">16.7.1</span> Modelling individual means with random intercepts</h3>
<p>We can consider each subject’s mean vocal pitch and in our model we will assume different random intercepts for each subject. The mixed model estimates these intercepts for us.</p>
<p>We are going to use the package <code>lme4</code> and the function <code>lmer()</code> and then fit a model with only the random effect of subject (each subject gets their own intercept).</p>
<div id="random-intercept-only-model" class="section level4" number="16.7.1.1">
<h4><span class="header-section-number">16.7.1.1</span> Random intercept only model</h4>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="m3.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;lme4&quot;)</span></span>
<span id="cb114-2"><a href="m3.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># load the package</span></span>
<span id="cb114-3"><a href="m3.html#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="m3.html#cb114-4" aria-hidden="true" tabindex="-1"></a>sub_only <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> subject),  <span class="at">data =</span> polite_data)</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="m3.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sub_only)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: frequency ~ (1 | subject)
##    Data: polite_data
## 
## REML criterion at convergence: 828.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.4980 -0.6071 -0.1817  0.6433  2.7520 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  subject  (Intercept) 4003     63.27   
##  Residual              940     30.66   
## Number of obs: 84, groups:  subject, 6
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   192.66      26.04   7.397</code></pre>
</div>
<div id="what-does-this-model-do" class="section level4" number="16.7.1.2">
<h4><span class="header-section-number">16.7.1.2</span> What does this model do?</h4>
<p><code>(1 | subject)</code> is the R syntax for a random intercept. It asks that we assume there is a different intercept for each subject. The ‘1’ stands for the intercept and the term to the right of the ‘|’ should be a nominal or factor variable to be used for the random effect. You can think of this formula as telling your model that it should expect that there’s going to be multiple responses per subject, and these responses will depend on each subject’s baseline level. This effectively resolves the non-independence that stems from having multiple responses by the same subject.</p>
</div>
<div id="interpreting-this-output" class="section level4" number="16.7.1.3">
<h4><span class="header-section-number">16.7.1.3</span> Interpreting this output</h4>
<p>From top to bottom:</p>
<ul>
<li>The model was fit using restricted maximum likelihood (REML) - what is that? We’ll see soon.<br />
</li>
<li>Then we are shown our formula again and the data this model was fit with.</li>
<li>The next two parts we won’t use much: there is much deeper you could go on the fitting and convergence of these models, but that is not within our scope, and we expect to see the scaled residuals centered near to 0.</li>
<li>The next part gives us the estimated variances for the random effects in the model. Recall the variances we calculated diretly in the Statdew Valley activity.</li>
<li>Finally, we have the fixed effect portions of the model, with a separate intercept but nothing else yet because we haven’t added any fixed effects.</li>
</ul>
</div>
<div id="adding-our-fixed-effects" class="section level4" number="16.7.1.4">
<h4><span class="header-section-number">16.7.1.4</span> Adding our fixed effects</h4>
<p>We’re interested in the effects of a formal/informal scenario and sex on the pitch of the subject’s voice, so we’ll add these as fixed effects.</p>
<p><strong>Question of interest: What is the influence of formal vs informal condition on voice pitch in speakers of this language, while accounting for sex and variation within subjects?</strong></p>
</div>
<div id="model-with-condition-and-sex" class="section level4" number="16.7.1.5">
<h4><span class="header-section-number">16.7.1.5</span> Model with condition and sex</h4>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="m3.html#cb117-1" aria-hidden="true" tabindex="-1"></a>w_fixed <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data=</span>polite_data)</span>
<span id="cb117-2"><a href="m3.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(w_fixed)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: frequency ~ condition + sex + (1 | subject)
##    Data: polite_data
## 
## REML criterion at convergence: 795.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3629 -0.5677 -0.2082  0.4615  3.2900 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  subject  (Intercept) 599.5    24.49   
##  Residual             844.6    29.06   
## Number of obs: 84, groups:  subject, 6
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)        237.054     15.166  15.631
## conditioninformal   19.864      6.342   3.132
## sexM              -108.660     20.974  -5.181
## 
## Correlation of Fixed Effects:
##             (Intr) cndtnn
## condtnnfrml -0.209       
## sexM        -0.691  0.000</code></pre>
<p><strong><em>You should be able to interpret the fixed effects in the way you are used to from linear models. Interpret the fixed effects coefficients below.</em></strong></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="m3.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(w_fixed)</span></code></pre></div>
<pre><code>##       (Intercept) conditioninformal              sexM 
##         237.05357          19.86429        -108.65952</code></pre>
<p>Males have lower pitches than females by an average of 109 Hz and in informal situations speakers have a higher pitch by about 20 Hz on average.</p>
</div>
<div id="aside-summary-of-means" class="section level4" number="16.7.1.6">
<h4><span class="header-section-number">16.7.1.6</span> Aside: Summary of means</h4>
<p><img src="images/m3/aside.png" width="910%" /></p>
<p>This gives us a general idea of what is going on…but doesn’t account for variability at all! Maybe these differences don’t actually mean anything in the context of the variability of our data. That is why we want to take a modelling approach.</p>
</div>
<div id="random-slopes-for-condition" class="section level4" number="16.7.1.7">
<h4><span class="header-section-number">16.7.1.7</span> Random slopes for condition</h4>
<p>Previously we assumed that the effect of formal/informal conditions were the same for all subjects (one coefficient for this variable). However, the effect of the condition might be <em>different for different subjects</em>; that is, there might be a condition and subject interaction. For example, it might be expected that some people are more polite in formal scenarios, others less. We need a random slope model, where subjects and items are not only allowed to have differing intercepts, but where they are also allowed to have different slopes for the effect of formality on pitch.</p>
<p><img src="images/m3/subject_slopes.png" width="600" /></p>
<p><strong><em>Do you think the slopes are different for different subjects?</em></strong></p>
<p>Note: The following model generates that warning <code>boundary (singular) fit: see ?isSingular</code> because our random effects are very small. This is an indication that we may be overfitting. We are including a random effect that we might not need to…(which, spoilers! is what we’ll find out at the end of this secion using our model comparison).</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="m3.html#cb121-1" aria-hidden="true" tabindex="-1"></a>w_slopes <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">|</span> subject),  <span class="at">data =</span> polite_data)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="m3.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(w_slopes)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: frequency ~ condition + sex + (1 + condition | subject)
##    Data: polite_data
## 
## REML criterion at convergence: 795.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3537 -0.5822 -0.2209  0.4785  3.2847 
## 
## Random effects:
##  Groups   Name              Variance Std.Dev. Corr 
##  subject  (Intercept)       621.9309 24.939        
##           conditioninformal   0.8045  0.897   -1.00
##  Residual                   844.3846 29.058        
## Number of obs: 84, groups:  subject, 6
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)        237.737     15.279  15.560
## conditioninformal   19.864      6.352   3.127
## sexM              -110.027     20.946  -5.253
## 
## Correlation of Fixed Effects:
##             (Intr) cndtnn
## condtnnfrml -0.246       
## sexM        -0.685  0.000
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<p>These new condition slopes are looking pretty similar…</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="m3.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(w_slopes)</span></code></pre></div>
<pre><code>## $subject
##    (Intercept) conditioninformal      sexM
## F1    223.1947          20.38733 -110.0272
## F2    247.4326          19.51559 -110.0272
## F3    240.4958          19.76508 -110.0272
## M3    266.7502          18.82080 -110.0272
## M4    243.5792          19.65418 -110.0272
## M7    204.9719          21.04275 -110.0272
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
<p>Let’s compare some models. <code>lmtest::lrtest</code> will run a likelihood ratio test for us.</p>
<p><strong><em>What is your conclusion? Do we need the random slopes?</em></strong></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="m3.html#cb127-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(w_fixed, w_slopes)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: frequency ~ condition + sex + (1 | subject)
## Model 2: frequency ~ condition + sex + (1 + condition | subject)
##   #Df LogLik Df  Chisq Pr(&gt;Chisq)
## 1   5 -397.9                     
## 2   7 -397.9  2 0.0119     0.9941</code></pre>
<p>Note: We can happily do a likelihood ratio test because we have the same fixed effects and are only comparing nested random effects here. See the <a href="m3.html#reml">additional considerations section</a> for why I mention this.</p>
<p>Conclusion from this test: The slopes are an unnecessary complication to our model. (I.e., No evidence against the hypothesis that the simpler model explains the data just as well.)</p>
</div>
<div id="scenario-random-intercepts" class="section level4" number="16.7.1.8">
<h4><span class="header-section-number">16.7.1.8</span> Scenario random intercepts</h4>
<p><strong><em>Does adding random intercepts for the scenarios improve the model?</em></strong></p>
<p><img src="images/m3/scen_int.png" width="600" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="m3.html#cb129-1" aria-hidden="true" tabindex="-1"></a>w_scen <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> condition <span class="sc">+</span> sex <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>scenario), <span class="at">data=</span>polite_data)</span>
<span id="cb129-2"><a href="m3.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(w_scen)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: frequency ~ condition + sex + (1 | subject) + (1 | scenario)
##    Data: polite_data
## 
## REML criterion at convergence: 784
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.2717 -0.6326 -0.0833  0.5260  3.5191 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  scenario (Intercept) 222.0    14.90   
##  subject  (Intercept) 614.4    24.79   
##  Residual             637.0    25.24   
## Number of obs: 84, groups:  scenario, 7; subject, 6
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)        237.054     16.101  14.723
## conditioninformal   19.864      5.507   3.607
## sexM              -108.660     20.974  -5.181
## 
## Correlation of Fixed Effects:
##             (Intr) cndtnn
## condtnnfrml -0.171       
## sexM        -0.651  0.000</code></pre>
<p><strong><em>Does adding random intercepts for the scenarios improve the model?</em></strong></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="m3.html#cb131-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(w_scen, w_fixed)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: frequency ~ condition + sex + (1 | subject) + (1 | scenario)
## Model 2: frequency ~ condition + sex + (1 | subject)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   6 -391.98                         
## 2   5 -397.90 -1 11.851  0.0005765 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Conclusion from this test: Yes! Including a random effect for scenario does explain the data better. We have very strong evidence against the hypothesis that the simpler model fits the data just as well.</p>
</div>
</div>
<div id="scenario-random-slopes" class="section level3" number="16.7.2">
<h3><span class="header-section-number">16.7.2</span> Scenario random slopes</h3>
<p><strong><em>Does adding random slopes for the scenarios improve the model?</em></strong></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="m3.html#cb133-1" aria-hidden="true" tabindex="-1"></a>w_scen_slope <span class="ot">=</span> </span>
<span id="cb133-2"><a href="m3.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(frequency <span class="sc">~</span> condition <span class="sc">+</span> </span>
<span id="cb133-3"><a href="m3.html#cb133-3" aria-hidden="true" tabindex="-1"></a>                  sex <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> </span>
<span id="cb133-4"><a href="m3.html#cb133-4" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> condition<span class="sc">|</span>scenario), </span>
<span id="cb133-5"><a href="m3.html#cb133-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">data=</span>polite_data)</span></code></pre></div>
<p><img src="images/m3/scenario_slopes.png" width="600" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="m3.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(w_scen_slope)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: frequency ~ condition + sex + (1 | subject) + (1 + condition |  
##     scenario)
##    Data: polite_data
## 
## REML criterion at convergence: 783.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.1567 -0.6021 -0.1097  0.5033  3.4023 
## 
## Random effects:
##  Groups   Name              Variance Std.Dev. Corr 
##  scenario (Intercept)       278.2    16.680        
##           conditioninformal  72.3     8.503   -0.51
##  subject  (Intercept)       615.6    24.812        
##  Residual                   618.6    24.873        
## Number of obs: 84, groups:  scenario, 7; subject, 6
## 
## Fixed effects:
##                   Estimate Std. Error t value
## (Intercept)        237.054     16.342  14.506
## conditioninformal   19.864      6.308   3.149
## sexM              -108.660     20.973  -5.181
## 
## Correlation of Fixed Effects:
##             (Intr) cndtnn
## condtnnfrml -0.244       
## sexM        -0.642  0.000</code></pre>
<p><strong><em>Does adding random slopes for the scenarios improve the model?</em></strong></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="m3.html#cb136-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(w_scen, w_scen_slope)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: frequency ~ condition + sex + (1 | subject) + (1 | scenario)
## Model 2: frequency ~ condition + sex + (1 | subject) + (1 + condition | 
##     scenario)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)
## 1   6 -391.98                     
## 2   8 -391.79  2 0.3755     0.8288</code></pre>
<p>Conclusion from this test: We have no evidence against the claim that the model with the simpler random effects is as good a fit to the data as the model with the more complicated random effect structure.</p>
</div>
</div>
<div id="interactions-between-random-effects-and-fixed-effects" class="section level2" number="16.8">
<h2><span class="header-section-number">16.8</span> Interactions between random effects and fixed effects</h2>
<p>Recall the honey data from the Statdew Valley interactive.</p>
<blockquote>
<p>Your grandmother was a bit eccentric when it came to farm management. She swore that her bees produced more honey if she played them music in the morning. In fact, she even mentioned that she thought they particularly liked K-pop.</p>
</blockquote>
<blockquote>
<p>She left you some data that she thinks proves this. While the sample size isn’t that large, you decide to take a look anyways. The data is called <code>honey</code> and records the honey produced each month for each of her 6 hives (in grams). Each hive listened to each of the song options (Dynamite by BTS, Adagio in B minor by Mozart and No music) for a month, three times. The order was randomized for each hive. It took 9 months to collect this data and the information your grandmother left you says honey production should have been fairly constant over this period and that all the hives experienced the same weather conditions, food access, etc.</p>
</blockquote>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="m3.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(honey, <span class="at">width =</span> <span class="dv">80</span>) </span></code></pre></div>
<pre><code>## Rows: 54
## Columns: 3
## $ hive    &lt;int&gt; 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 1, 1, 1,…
## $ song    &lt;chr&gt; &quot;No music&quot;, &quot;No music&quot;, &quot;No music&quot;, &quot;No music&quot;, &quot;No music&quot;, &quot;N…
## $ honey_g &lt;dbl&gt; 196.56, 199.58, 200.71, 195.80, 199.58, 200.71, 226.80, 227.55…</code></pre>
<div id="model-formula-2" class="section level3" number="16.8.1">
<h3><span class="header-section-number">16.8.1</span> Model formula</h3>
<p>I said the model formula would look like this:</p>
<p><span class="math display">\[y_{ijk} = \mu + \alpha_i + b_{j} + + (\alpha b)_{ij} + \epsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(y_{ijk}\)</span> is the amount of honey produced (in grams) in the <span class="math inline">\(k^{th}\)</span> month by the <span class="math inline">\(j^{th}\)</span> hive while listening to song <span class="math inline">\(i\)</span>. Here, <span class="math inline">\(\mu\)</span> is the grand mean of honey production, <span class="math inline">\(\alpha_i\)</span> are the <span class="math inline">\(I\)</span> fixed effects for <code>song</code> and <span class="math inline">\(b_j\)</span> are the random effects for hive <span class="math inline">\(j\)</span>. <span class="math inline">\((\alpha b)_{ij}\)</span> are the <span class="math inline">\(IJ\)</span> interaction terms for the interaction between the the hive and the song. What does this represent here? Well, maybe some hives respond to a certain song quite differently to other hives. <span class="math inline">\((\alpha b)_{ij}\)</span> is a random effect because any term involving a random effect must also be a random effect. <span class="math inline">\((\alpha b)_{ij} ~ \sim N(0, \sigma^2_{\alpha b})\)</span>, <span class="math inline">\(b_k \sim N(0, \sigma_b^2)\)</span> and <span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>. All the random effects are mutually independent random variables.</p>
</div>
<div id="how-would-we-fit-this-with-lmer" class="section level3" number="16.8.2">
<h3><span class="header-section-number">16.8.2</span> How would we fit this with <code>lmer</code>?</h3>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="m3.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># library from which we load the lmer function</span></span></code></pre></div>
<p>This is how we would fit a model with <em>only</em> a hive effect:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="m3.html#cb141-1" aria-hidden="true" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(honey_g <span class="sc">~</span> song <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>hive), <span class="at">data =</span> honey)</span></code></pre></div>
<p>This is how we would fit our <strong>full</strong> model, with a hive effect AND a hive and song interaction:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="m3.html#cb142-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(honey_g <span class="sc">~</span> song <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>hive) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>hive<span class="sc">:</span>song), <span class="at">data =</span> honey)</span></code></pre></div>
<div id="do-we-need-the-interaction" class="section level4" number="16.8.2.1">
<h4><span class="header-section-number">16.8.2.1</span> Do we need the interaction?</h4>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="m3.html#cb143-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(mod1, mod0)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: honey_g ~ song + (1 | hive) + (1 | hive:song)
## Model 2: honey_g ~ song + (1 | hive)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   6 -175.66                         
## 2   5 -211.25 -1 71.199  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Conclusion: We get a really small p-value, so we have strong evidence against the hypothesis that the simper model, with no song/hive interaction is as good as our full model.</p>
</div>
</div>
</div>
<div id="more-fixed-vs-random-effects-practice" class="section level2" number="16.9">
<h2><span class="header-section-number">16.9</span> More fixed vs random effects practice</h2>
<p>Consider the following two examples from <a href="https://bookdown.org/roback/bookdown-BeyondMLR/ch-corrdata.html#exercises-6">Roback &amp; Legler (2021), section 7.10</a>.
<strong>Identify which variable is the response and which are the fixed effects and the random effects.</strong></p>
<blockquote>
<p>Cockroaches! For a study of cockroach infestation, traps were set up in the kitchen, bathroom, and bedroom in a random sample of 100 New York City apartments. The goal is to estimate cockroach infestation levels given tenant income and age of the building.</p>
</blockquote>
<p><strong>Variables: room type, tenant income,apartment, building age, building, count of cockroaches</strong></p>
<blockquote>
<p>Radon in Minnesota. Radon is a carcinogen – a naturally occurring radioactive gas whose decay products are also radioactive – known to cause lung cancer in high concentrations. The EPA sampled more than 80,000 homes across the U.S. Each house came from a randomly selected county and measurements were made on each level of each home. Uranium measurements at the county level were included to improve the radon estimates.</p>
</blockquote>
<p><strong>Variables: radon measurement, home, level of home, uranium, county</strong></p>
<div id="answers" class="section level3" number="16.9.1">
<h3><span class="header-section-number">16.9.1</span> Answers</h3>
<div id="cockroaches" class="section level4" number="16.9.1.1">
<h4><span class="header-section-number">16.9.1.1</span> Cockroaches</h4>
<ul>
<li>response: count of cockroaches</li>
<li>fixed effects: room type (kitchen, bathroom, bedroom), tenant income, building
age</li>
<li>random effects: apartment, building</li>
</ul>
</div>
<div id="radon" class="section level4" number="16.9.1.2">
<h4><span class="header-section-number">16.9.1.2</span> Radon</h4>
<ul>
<li>response: radon measurement</li>
<li>fixed effects: level of home (e.g. upper or lower level), uranium (county level variable)</li>
<li>random effects: home, county</li>
</ul>
</div>
</div>
</div>
<div id="advice-for-polishing-your-writing" class="section level2" number="16.10">
<h2><span class="header-section-number">16.10</span> Advice for polishing your writing</h2>
<p>The U of T writing advice site has some great short articles with tips about common writing mistakes and tips for improving your writing. The full list from the <a href="https://advice.writing.utoronto.ca/revising/">‘Revising’</a> section is below. Choose one or two that seem relevant to you and read them. If you don’t know where to start, go for the <a href="https://advice.writing.utoronto.ca/revising/hit-parade-of-errors/">‘Hit Parade’</a>.</p>
<ul>
<li><p><a href="https://advice.writing.utoronto.ca/revising/revising-and-editing/">Revising And Editing</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/hit-parade-of-errors/">Hit Parade Of Errors In Grammar, Punctuation, and Style</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/using-the-computer/">Using the Computer to Improve Your Writing</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/wordiness/">Wordiness: Danger Signals and Ways to React</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/unbiased-language/">Unbiased Language</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/punctuation/">Punctuation</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/comma-splices/">Fixing Comma Splices</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/faulty-parallelism/">Faulty Parallelism</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/passive-voice/">Passive Voice: When to Use It and When to Avoid It</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/dangling-modifiers/">Fixing Dangling Modifiers</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/spelling/">Some Tools and Rules to Improve Your Spelling</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/plurals/">Plurals</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/possessives/">Possessives</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/subject-verb-agreement/">Subject-Verb Agreement</a></p></li>
<li><p><a href="https://advice.writing.utoronto.ca/revising/sentence-fragments/">Sentence Fragments</a></p></li>
</ul>
<p>And <a href="https://advice.writing.utoronto.ca/using-sources/how-not-to-plagiarize/">How Not to Plaigarize</a> is always worth reviewing!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="m2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="m4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["STA303-Course-guide.pdf", "PDF"]],
"toc": {
"collapse": "section",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
